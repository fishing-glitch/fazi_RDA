<!DOCTYPE html>
<html lang="en-us">

<head>
  <title>Vehicle Accidents in Canada - Exploring and Classifying Severity | Fazi_RDA</title>

  <meta charset="UTF-8">
  <meta name="language" content="en">
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  
  

  <link rel="shortcut icon" type="image/png" href="/favicon.ico" />

  
  
    
 
  
  
  
  
  
  
    
    <link rel="stylesheet" href="/css/post.min.3b28d14676e4769849164baf362f2b0aa069ab25702fef98f0c4227cb68d74cd.css" integrity="sha256-OyjRRnbkdphJFkuvNi8rCqBpqyVwL&#43;&#43;Y8MQifLaNdM0="/>
  
    
    <link rel="stylesheet" href="/css/custom.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css" integrity="sha256-47DEQpj8HBSa&#43;/TImW&#43;5JCeuQeRkm5NMpJWZG3hSuFU="/>
  
  
   
   
    

<script type="application/ld+json">
  
    {
      "@context" : "http://schema.org",
      "@type" : "BlogPosting",
      "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "\/"
      },
      "articleSection" : "blog",
      "name" : "Vehicle Accidents in Canada - Exploring and Classifying Severity",
      "headline" : "Vehicle Accidents in Canada - Exploring and Classifying Severity",
      "description" : "",
      "inLanguage" : "en-US",
      "author" : "",
      "creator" : "",
      "publisher": "",
      "accountablePerson" : "",
      "copyrightHolder" : "",
      "copyrightYear" : "0001",
      "datePublished": "0001-01-01 00:00:00 \u002b0000 UTC",
      "dateModified" : "0001-01-01 00:00:00 \u002b0000 UTC",
      "url" : "\/blog\/accidents-canada\/",
      "wordCount" : "9564",
      "keywords" : ["Blog"]
    }
  
  </script>
</head>

<body>
  <div class="burger__container">
  <div class="burger" aria-controls="navigation" aria-label="Menu">
    <div class="burger__meat burger__meat--1"></div>
    <div class="burger__meat burger__meat--2"></div>
    <div class="burger__meat burger__meat--3"></div>
  </div>
</div>
 

  <nav class="nav" role="navigation">
  <ul class="nav__list">
    
    
      <li>
        <a  href="/">about</a>
      </li>
    
      <li>
        <a  class="active"
         href="/blog">projects</a>
      </li>
    
  </ul>
</nav>


  <main>
    
    

    <div class="flex-wrapper">
      <div class="post__container">
        <div class="post">
          <header class="post__header">
            <h1 id="post__title">Vehicle Accidents in Canada - Exploring and Classifying Severity</h1>
            <time datetime="0001-01-01 00:00:00 &#43;0000 UTC" class="post__date"
            > </time>
          </header>
          <article class="post__content">
              

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotly-main/plotly-latest.min.js"></script>


<div id="introduction" class="section level3">
<h3>Introduction</h3>
<p>The following analysis is performed on data describing various vehicle accidents in Canada during the years 1999-2014. The focus is on how severe the accidents were in terms of fatalities and injuries. The link between the degree of severity and majority of the other given variables (features) is explored through visualizations. A couple of simple machine learning models are also fit to the dataset to explore whether there is any useful potential for being able to predict fatalities based on the provided features. The data was freely obtained from <a href="https://www.kaggle.com/tbsteal/canadian-car-accidents-19942014" class="uri">https://www.kaggle.com/tbsteal/canadian-car-accidents-19942014</a> , where more information and additional relevant files can be viewed as well.</p>
<p>To begin, the relevant libraries and the data is loaded.</p>
<pre class="r"><code>#Libraries
library(tidyverse)
library(lsr)
library(plotly)
library(ROSE)
library(rsample)
library(caret)
library(ROCR)

#Import Data 
acc &lt;- read.csv(&quot;NCDB-1999-to-2014.csv&quot;)</code></pre>
</div>
<div id="defining-the-variables" class="section level3">
<h3>Defining the Variables</h3>
<p>The initial dataset comprises of 5,860,405 total observations for 22 different variables. The data is therefore substantial in size. Before moving on to the actual analysis, it may be useful to briefly describe the different variables present (and also to avoid constantly referring to the pdf guide in the link given above).</p>
<ol style="list-style-type: decimal">
<li><p>C_YEAR = Year =&gt; ranging from 1999-2014</p></li>
<li><p>C_MNTH = Month =&gt; numerically coded 01-12, in line with January-December</p></li>
<li><p>C_WDAY = Day of Week =&gt; numerically coded 1-7, in line with Monday-Sunday</p></li>
<li><p>C_HOUR = Collision Hour =&gt; numerically coded 00-23, where 00 is midnight to 0:59, 01 is 1:00 to 1:59, and so on until 23 is 23:00 to 23:59</p></li>
<li><p>C_SEV = Collision severity =&gt; numerically coded 1(at least one fatality) and 2(non-fatal injury or no injury)</p></li>
<li><p>C_VEHS = Number of vehicles involved =&gt; 1, 2, 3….., 98 vehicles involved, or 99+ vehicles involved</p></li>
<li><p>C_CONF = Collision configuration =&gt; divided into four different sub categories:</p></li>
</ol>
<ul>
<li><ol style="list-style-type: lower-alpha">
<li>Single vehicle in motion:</li>
</ol>
<ul>
<li>01 =&gt; Hit a moving object</li>
<li>02 =&gt; Hit a stationary object</li>
<li>03 =&gt; Ran off left shoulder</li>
<li>04 =&gt; Ran off right shoulder</li>
<li>05 =&gt; Rollover on roadway</li>
<li>06 =&gt; Any other single vehicle collision configuration</li>
</ul></li>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>Two vehicles in motion - same direction of travel:</li>
</ol>
<ul>
<li>21 =&gt; Rear-end collision</li>
<li>22 =&gt; Side swipe</li>
<li>23 =&gt; One vehicle passing to the left of the other, or left turn conflict</li>
<li>24 =&gt; One vehicle passing to the right of the other, or right turn conflict</li>
<li>25 =&gt; Any other two vehicle - same direction of travel configuration</li>
</ul></li>
<li><ol start="3" style="list-style-type: lower-alpha">
<li>Two vehicles in motion - different direction of travel:</li>
</ol>
<ul>
<li>31 =&gt; Head-on collision</li>
<li>32 =&gt; Approaching side-swipe</li>
<li>33 =&gt; Left turn across opposing traffic</li>
<li>34 =&gt; Right turn, including turning conflicts</li>
<li>35 =&gt; Right angle collision</li>
<li>36 =&gt; Any other two-vehicle - different direction of travel configuration</li>
</ul></li>
<li><ol start="4" style="list-style-type: lower-alpha">
<li>Two vehicles - hit a parked vehicle</li>
</ol>
<ul>
<li>41 =&gt; Hit a parked motor vehicle</li>
</ul></li>
</ul>
<ol start="8" style="list-style-type: decimal">
<li><p>C_RCFG = Roadway configuration =&gt; 12 categories as follows:</p>
<ul>
<li>01 =&gt; Non-intersection</li>
<li>02 =&gt; At an intersection of at least two public roadways</li>
<li>03 =&gt; Intersection with parking lot entrance/exit, private driveway/laneway</li>
<li>04 =&gt; Railroad level crossing</li>
<li>05 =&gt; Bridge, overpass, viaduct</li>
<li>06 =&gt; Tunnel or underpass</li>
<li>07 =&gt; Passing or climbing lane</li>
<li>08 =&gt; Ramp</li>
<li>09 =&gt; Traffic circle</li>
<li>10 =&gt; Express lane of a freeway system</li>
<li>11 =&gt; Collector lane of a freeway system</li>
<li>12 =&gt; Transfer lane of a freeway system</li>
</ul></li>
<li><p>C_WTHR = Weather condition =&gt; 7 categories as follows:</p>
<ul>
<li>1 =&gt; Clear and sunny</li>
<li>2 =&gt; Overcast, cloudy but no precipitation</li>
<li>3 =&gt; Raining</li>
<li>4 =&gt; Snowing, not including drifting snow</li>
<li>5 =&gt; Freezing rain, sleet, hail</li>
<li>6 =&gt; Visibility limitation e.g. drifting snow, fog, smog, dust, smoke, mist</li>
<li>7 =&gt; Strong wind</li>
</ul></li>
<li><p>C_RSUR = Road surface =&gt; 9 categories as follows:</p>
<ul>
<li>1 =&gt; Dry, normal</li>
<li>2 =&gt; Wet</li>
<li>3 =&gt; Snow (fresh, loose snow)</li>
<li>4 =&gt; Slush ,wet snow</li>
<li>5 =&gt; Icy Includes packed snow</li>
<li>6 =&gt; Sand/gravel/dirt</li>
<li>7 =&gt; Muddy</li>
<li>8 =&gt; Oil</li>
<li>9 =&gt; Flooded</li>
</ul></li>
<li><p>C_RALN = Road alignment =&gt; 6 categories as follows:</p>
<ul>
<li>1 =&gt; Straight and level</li>
<li>2 =&gt; Straight with gradient</li>
<li>3 =&gt; Curved and level</li>
<li>4 =&gt; Curved with gradient</li>
<li>5 =&gt; Top of hill or gradient</li>
<li>6 =&gt; Bottom of hill or gradient</li>
</ul></li>
<li><p>C_TRAF = Traffic control =&gt; 18 categories as follows:</p>
<ul>
<li>01 =&gt; Traffic signals fully operational</li>
<li>02 =&gt; Traffic signals in flashing mode</li>
<li>03 =&gt; Stop sign</li>
<li>04 =&gt; Yield sign</li>
<li>05 =&gt; Warning sign</li>
<li>06 =&gt; Pedestrian crosswalk</li>
<li>07 =&gt; Police officer</li>
<li>08 =&gt; School guard, flagman</li>
<li>09 =&gt; School crossing</li>
<li>10 =&gt; Reduced speed zone</li>
<li>11 =&gt; No passing zone sign</li>
<li>12 =&gt; Markings on the road e.g. no passing</li>
<li>13 =&gt; School bus stopped with school bus signal lights flashing</li>
<li>14 =&gt; School bus stopped with school bus signal lights not flashing</li>
<li>15 =&gt; Railway crossing with signals, or signals and gates</li>
<li>16 =&gt; Railway crossing with signs only</li>
<li>17 =&gt; Control device not specified</li>
<li>18 =&gt; No control present</li>
</ul></li>
<li><p>V_ID = Vehicle sequence number =&gt; unique ID number 1-98 (99 for pedestrians)</p></li>
<li><p>V_TYPE = Vehicle type =&gt; 17 categories as follows:</p>
<ul>
<li>01 =&gt; Light Duty Vehicle</li>
<li>05 =&gt; Panel/cargo van &lt;= 4536 KG GVWR</li>
<li>06 =&gt; Other trucks and vans &lt;= 4536 KG GVWR</li>
<li>07 =&gt; Unit trucks &gt; 4536 KG GVWR</li>
<li>08 =&gt; Road tractor With or without a semi-trailer</li>
<li>09 =&gt; School bus Standard large type</li>
<li>10 =&gt; Smaller school bus Smaller type, seats &lt; 25 passengers</li>
<li>11 =&gt; Urban and Intercity Bus</li>
<li>14 =&gt; Motorcycle and moped Motorcycle and limited-speed motorcycle</li>
<li>16 =&gt; Off road vehicles Off road motorcycles</li>
<li>17 =&gt; Bicycle</li>
<li>18 =&gt; Purpose-built motorhome Exclude pickup campers</li>
<li>19 =&gt; Farm equipment</li>
<li>20 =&gt; Construction equipment</li>
<li>21 =&gt; Fire engine</li>
<li>22 =&gt; Snowmobile</li>
<li>23 =&gt; Street car</li>
</ul></li>
<li><p>V_YEAR = Vehicle model year =&gt; ranging from early 90s to 20xx.</p></li>
<li><p>P_ID = Person Sequence Number =&gt; unique ID number 01-99</p></li>
<li><p>P_SEX = Person sex =&gt; M (male), F (female)</p></li>
<li><p>P_AGE = Person age =&gt; age range from 00 (less than a year old) to 99 (or older)</p></li>
<li><p>P_PSN = Person position =&gt; 13 categories as follows:</p>
<ul>
<li>11 =&gt; Driver</li>
<li>12 =&gt; Front row, center</li>
<li>13 =&gt; Front row, right outboard, including motorcycle passenger in sidecar</li>
<li>21 =&gt; Second row, left outboard, including motorcycle passenger</li>
<li>22 =&gt; Second row, center</li>
<li>23 =&gt; Second row, right outboard</li>
<li>31 =&gt; Third row, left outboard</li>
<li>32 =&gt; Third row, center</li>
<li>33 =&gt; Third row, right outboard</li>
<li>96 =&gt; Position unknown, but the person was definitely an occupant</li>
<li>97 =&gt; Sitting on someone’s lap</li>
<li>98 =&gt; Outside passenger compartment</li>
<li>99 =&gt; Pedestrian</li>
</ul></li>
<li><p>P_ISEV = Medical treatment required =&gt; three categories, 1 (no injury), 2 (injury) and 3 (fatality)</p></li>
<li><p>P_SAFE = Safety device used =&gt; 7 categories as follows:</p>
<ul>
<li>01 =&gt; No safety device used or No child restraint used</li>
<li>02 =&gt; Safety device used or child restraint used</li>
<li>09 =&gt; Helmet worn</li>
<li>10 =&gt; Reflective clothing worn</li>
<li>11 =&gt; Both helmet and reflective clothing used</li>
<li>12 =&gt; Other safety device used</li>
<li>13 =&gt; No safety device equipped</li>
</ul></li>
<li><p>P_USER = Road user class =&gt; 5 categories as follows:</p>
<ul>
<li>1 =&gt; Motor Vehicle Driver</li>
<li>2 =&gt; Motor Vehicle Passenger</li>
<li>3 =&gt; Pedestrian</li>
<li>4 =&gt; Bicyclist</li>
<li>5 =&gt; Motorcyclist</li>
</ul></li>
</ol>
<p>Along these variables, other categories have also been defined to describe data that is missing or was not provided. These are labeled as “UU”, “XX”, “U”, “X”, “QQ”, “Q”, “NN”, “NNNN”, “UUUU”, “XXXX”, “N”. It should also be noted that all the features are completely categorical in nature (no numerical properties), therefore making this data suitable for classification analysis and modeling.</p>
</div>
<div id="data-cleaningprocessing" class="section level3">
<h3>Data Cleaning/Processing</h3>
<p>Before moving on to the analysis, the data needs to be slightly processed. Firstly, all rows including the labeled missing values are removed as there is no reliable information that can be used for other options such as imputing. However, since the number of rows is already exceeding 5 million, there should not be a significant loss in information from this removal. In fact, once the removal took place the only noticeable loss of information was from there being no data present for pedestrian related accidents. After discounting the missing values, there are a little over 3 million observations left, which is still substantial enough. The unique vehicle and person ID variables are then removed as they serve no real importance for the purpose of this analysis, leaving 20 variables. Finally, all variables are converted to factor type to account for their categorical nature. This is all carried out in the code chunk below.</p>
<pre class="r"><code>#removing unknown observations

acc_clean &lt;- acc

unknown_vals &lt;- c(&quot;UU&quot;, &quot;XX&quot;, &quot;U&quot;, &quot;X&quot;, &quot;QQ&quot;, &quot;Q&quot;, &quot;NN&quot;, &quot;NNNN&quot;, &quot;UUUU&quot;, &quot;XXXX&quot;, &quot;N&quot;)

for (i in 1:22){
  acc_clean &lt;- subset(acc_clean, !  acc_clean[,i] %in% unknown_vals)
} #left with 3,295,339 obs from 22 variables


#removing vehicle and person sequence number variables

acc_clean &lt;- acc_clean[, c(-13, -16)]

#converting to factor

acc_clean$C_YEAR &lt;- as.factor(acc_clean$C_YEAR)
acc_clean$C_SEV &lt;- as.factor(acc_clean$C_SEV)

acc_clean &lt;- acc_clean %&gt;%
  mutate_if(is.character, as.factor)</code></pre>
</div>
<div id="exploratory-analysis" class="section level3">
<h3>Exploratory Analysis</h3>
<p>Now that the data is processed, it can be explored. As mentioned previously, the main focus is going to be how most of these variables interact with the total number and severity of the accidents. The charts are maintained to be as simple as possible, without any unnecessary complexity, to convey the insights clearly. Almost all the charts are interactive as well, to help with readability (it may be better to view these on a computer screen than on a phone).</p>
<p>Starting simply, the progression of the number of accidents through the years is shown in tables below. The top table refers to the data from the cleaned dataset, which shows a gradual declining trend in the number of accidents as the years go by. This isn’t really surprising, as with time it is plausible that safety measures in both vehicles and roads would improve, thus leading to lower accident numbers. To confirm this declining trend (and to validate the clean data), the original raw dataset is also used, which too shows a declining trend, albeit with a slightly steeper drop.</p>
<pre class="r"><code># Number of accidents progression per year (table)
table(acc_clean$C_YEAR) # clean data</code></pre>
<pre><code>## 
##   1999   2000   2001   2002   2003   2004   2005   2006   2007   2008 
## 226702 236319 230747 237313 230052 220775 220115 211215 205407 188927 
##   2009   2010   2011   2012   2013   2014 
## 185791 190526 184304 180971 179858 166317</code></pre>
<pre class="r"><code>table(acc$C_YEAR) # original data</code></pre>
<pre><code>## 
##   1999   2000   2001   2002   2003   2004   2005   2006   2007   2008 
## 413509 422075 409389 420008 407036 389050 386470 378523 368507 338268 
##   2009   2010   2011   2012   2013   2014 
## 330771 334555 325153 322421 317058 297612</code></pre>
<p>The number of accidents varies slightly with each month, but not to a significant degree. The highest number of accidents take place in June, July and August, while the lowest numbers are in February, March and April. This may be due to weather changes during these months, with better weather in the middle of the year.</p>
<pre class="r"><code>#Distribution of accidents per month

ggplotly(ggplot(acc_clean, aes(C_MNTH)) +
  geom_histogram(stat = &quot;count&quot;, fill = &quot;deepskyblue3&quot;, color = &quot;black&quot;) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle(&quot;Distribution of accidents per month&quot;) +
  theme_minimal())</code></pre>
<div id="htmlwidget-1" style="width:720px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999],"base":[0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7,8,9,10,11,12],"y":[275989,238206,231061,225387,268103,294840,303325,308262,287533,292112,278775,291746],"text":["count: 275989<br />C_MNTH: 01","count: 238206<br />C_MNTH: 02","count: 231061<br />C_MNTH: 03","count: 225387<br />C_MNTH: 04","count: 268103<br />C_MNTH: 05","count: 294840<br />C_MNTH: 06","count: 303325<br />C_MNTH: 07","count: 308262<br />C_MNTH: 08","count: 287533<br />C_MNTH: 09","count: 292112<br />C_MNTH: 10","count: 278775<br />C_MNTH: 11","count: 291746<br />C_MNTH: 12"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,154,205,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.7108066971081,"r":7.30593607305936,"b":42.130898021309,"l":66.4840182648402},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Distribution of accidents per month","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,12.6],"tickmode":"array","ticktext":["01","02","03","04","05","06","07","08","09","10","11","12"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12],"categoryorder":"array","categoryarray":["01","02","03","04","05","06","07","08","09","10","11","12"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"C_MNTH","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-15413.1,323675.1],"tickmode":"array","ticktext":["0","100,000","200,000","300,000"],"tickvals":[0,100000,200000,300000],"categoryorder":"array","categoryarray":["0","100,000","200,000","300,000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"401443916d5d":{"x":{},"type":"bar"}},"cur_data":"401443916d5d","visdat":{"401443916d5d":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>There is not significant variation in the number of accidents during the week as well, with the highest number being on Friday and lowest number being on Sunday. Hovering the cursor (or tapping) on the charts will show the exact numbers.</p>
<pre class="r"><code>#Distribution of accidents per weekday

ggplotly(ggplot(acc_clean, aes(C_WDAY)) +
  geom_histogram(stat = &quot;count&quot;, fill = &quot;deepskyblue3&quot;, color = &quot;black&quot;) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle(&quot;Distribution of accidents per weekday&quot;) +
  theme_minimal())</code></pre>
<p><div id="htmlwidget-2" style="width:720px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9],"base":[0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7],"y":[433255,455812,457760,483882,561854,496803,405973],"text":["count: 433255<br />C_WDAY: 1","count: 455812<br />C_WDAY: 2","count: 457760<br />C_WDAY: 3","count: 483882<br />C_WDAY: 4","count: 561854<br />C_WDAY: 5","count: 496803<br />C_WDAY: 6","count: 405973<br />C_WDAY: 7"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,154,205,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.7108066971081,"r":7.30593607305936,"b":42.130898021309,"l":66.4840182648402},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Distribution of accidents per weekday","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,7.6],"tickmode":"array","ticktext":["1","2","3","4","5","6","7"],"tickvals":[1,2,3,4,5,6,7],"categoryorder":"array","categoryarray":["1","2","3","4","5","6","7"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"C_WDAY","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-28092.7,589946.7],"tickmode":"array","ticktext":["0","200,000","400,000"],"tickvals":[0,200000,400000],"categoryorder":"array","categoryarray":["0","200,000","400,000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"40141db376fd":{"x":{},"type":"bar"}},"cur_data":"40141db376fd","visdat":{"40141db376fd":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
There is a lot more variation of the number of accidents per hour, with majority of the accidents taking place between 11:00 and 20:00. This is probably due to higher traffic levels during these hours. There is also a minor spike between 08:00 and 09:00, which can be because of the morning commute to work. The level of severity or injury however appears to be consistent with the number of accidents in total, showing little variation.</p>
<pre class="r"><code>#Distribution of accidents and severity per hour

ggplotly(ggplot(acc_clean, aes(C_HOUR)) +
  geom_histogram(aes(fill = C_SEV), stat = &quot;count&quot;, color = &quot;black&quot;) +
  scale_y_continuous(labels = scales::comma) +
  scale_fill_manual(values = c(&quot;red&quot;, &quot;slategray1&quot;)) +
  ggtitle(&quot;Distribution of accidents and severity per hour&quot;) +
  theme_minimal())</code></pre>
<p><div id="htmlwidget-3" style="width:720px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-3">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999],"base":[45913,37452,37477,32409,20914,24527,61073,116411,171390,131211,142030,172141,206794,207132,223534,277000,292642,282459,213830,156191,118232,111246,90540,68901],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[1601,1566,1650,1414,848,1052,1449,1952,1930,2000,2117,2380,2777,2728,3211,3582,3795,3560,3161,2676,2404,2140,2101,1796],"text":["count:   1601<br />C_SEV: 1<br />C_HOUR: 00","count:   1566<br />C_SEV: 1<br />C_HOUR: 01","count:   1650<br />C_SEV: 1<br />C_HOUR: 02","count:   1414<br />C_SEV: 1<br />C_HOUR: 03","count:    848<br />C_SEV: 1<br />C_HOUR: 04","count:   1052<br />C_SEV: 1<br />C_HOUR: 05","count:   1449<br />C_SEV: 1<br />C_HOUR: 06","count:   1952<br />C_SEV: 1<br />C_HOUR: 07","count:   1930<br />C_SEV: 1<br />C_HOUR: 08","count:   2000<br />C_SEV: 1<br />C_HOUR: 09","count:   2117<br />C_SEV: 1<br />C_HOUR: 10","count:   2380<br />C_SEV: 1<br />C_HOUR: 11","count:   2777<br />C_SEV: 1<br />C_HOUR: 12","count:   2728<br />C_SEV: 1<br />C_HOUR: 13","count:   3211<br />C_SEV: 1<br />C_HOUR: 14","count:   3582<br />C_SEV: 1<br />C_HOUR: 15","count:   3795<br />C_SEV: 1<br />C_HOUR: 16","count:   3560<br />C_SEV: 1<br />C_HOUR: 17","count:   3161<br />C_SEV: 1<br />C_HOUR: 18","count:   2676<br />C_SEV: 1<br />C_HOUR: 19","count:   2404<br />C_SEV: 1<br />C_HOUR: 20","count:   2140<br />C_SEV: 1<br />C_HOUR: 21","count:   2101<br />C_SEV: 1<br />C_HOUR: 22","count:   1796<br />C_SEV: 1<br />C_HOUR: 23"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[45913,37452,37477,32409,20914,24527,61073,116411,171390,131211,142030,172141,206794,207132,223534,277000,292642,282459,213830,156191,118232,111246,90540,68901],"text":["count:  45913<br />C_SEV: 2<br />C_HOUR: 00","count:  37452<br />C_SEV: 2<br />C_HOUR: 01","count:  37477<br />C_SEV: 2<br />C_HOUR: 02","count:  32409<br />C_SEV: 2<br />C_HOUR: 03","count:  20914<br />C_SEV: 2<br />C_HOUR: 04","count:  24527<br />C_SEV: 2<br />C_HOUR: 05","count:  61073<br />C_SEV: 2<br />C_HOUR: 06","count: 116411<br />C_SEV: 2<br />C_HOUR: 07","count: 171390<br />C_SEV: 2<br />C_HOUR: 08","count: 131211<br />C_SEV: 2<br />C_HOUR: 09","count: 142030<br />C_SEV: 2<br />C_HOUR: 10","count: 172141<br />C_SEV: 2<br />C_HOUR: 11","count: 206794<br />C_SEV: 2<br />C_HOUR: 12","count: 207132<br />C_SEV: 2<br />C_HOUR: 13","count: 223534<br />C_SEV: 2<br />C_HOUR: 14","count: 277000<br />C_SEV: 2<br />C_HOUR: 15","count: 292642<br />C_SEV: 2<br />C_HOUR: 16","count: 282459<br />C_SEV: 2<br />C_HOUR: 17","count: 213830<br />C_SEV: 2<br />C_HOUR: 18","count: 156191<br />C_SEV: 2<br />C_HOUR: 19","count: 118232<br />C_SEV: 2<br />C_HOUR: 20","count: 111246<br />C_SEV: 2<br />C_HOUR: 21","count:  90540<br />C_SEV: 2<br />C_HOUR: 22","count:  68901<br />C_SEV: 2<br />C_HOUR: 23"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(198,226,255,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.7108066971081,"r":7.30593607305936,"b":42.130898021309,"l":66.4840182648402},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Distribution of accidents and severity per hour","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,24.6],"tickmode":"array","ticktext":["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"categoryorder":"array","categoryarray":["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"C_HOUR","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-14821.85,311258.85],"tickmode":"array","ticktext":["0","100,000","200,000","300,000"],"tickvals":[0,100000,200000,300000],"categoryorder":"array","categoryarray":["0","100,000","200,000","300,000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.963910761154856},"annotations":[{"text":"C_SEV","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"40141a213bd9":{"fill":{},"x":{},"type":"bar"}},"cur_data":"40141a213bd9","visdat":{"40141a213bd9":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
Examining the relationship between the collision configuration and the severity of the accidents provides some unique insights. The charts show that majority of the severe (fatal) accidents resulted when there was a head-on collision between two vehicles, whereas majority of the non-severe (little to no injury) accidents resulted when there was a rear-end collision between two vehicles.</p>
<pre class="r"><code>#Collision configuration with accident severity

ggplotly(ggplot(subset(acc_clean, C_SEV == &quot;1&quot;), aes(C_SEV)) +
  geom_bar(aes(fill = C_CONF), stat = &quot;count&quot;, color = &quot;black&quot;, 
           position = &quot;dodge&quot;) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle(&quot;Collision configuration for severe accidents&quot;) +
  theme_minimal())</code></pre>
<div id="htmlwidget-4" style="width:720px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-4">{"x":{"data":[{"orientation":"v","width":0.05,"base":0,"x":[0.575],"y":[868],"text":"count:   868<br />C_CONF: 01<br />C_SEV: 1","type":"bar","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"01","legendgroup":"01","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.05,"base":0,"x":[0.625],"y":[1892],"text":"count:  1892<br />C_CONF: 02<br />C_SEV: 1","type":"bar","marker":{"autocolorscale":false,"color":"rgba(232,133,38,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"02","legendgroup":"02","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.05,"base":0,"x":[0.675],"y":[3443],"text":"count:  3443<br />C_CONF: 03<br />C_SEV: 1","type":"bar","marker":{"autocolorscale":false,"color":"rgba(211,146,0,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"03","legendgroup":"03","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.05,"base":0,"x":[0.725],"y":[3993],"text":"count:  3993<br />C_CONF: 04<br />C_SEV: 1","type":"bar","marker":{"autocolorscale":false,"color":"rgba(183,159,0,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"04","legendgroup":"04","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.05,"base":0,"x":[0.775],"y":[167],"text":"count:   167<br />C_CONF: 05<br />C_SEV: 1","type":"bar","marker":{"autocolorscale":false,"color":"rgba(147,170,0,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"05","legendgroup":"05","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.05,"base":0,"x":[0.825],"y":[7574],"text":"count:  7574<br />C_CONF: 06<br />C_SEV: 1","type":"bar","marker":{"autocolorscale":false,"color":"rgba(94,179,0,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"06","legendgroup":"06","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.05,"base":0,"x":[0.875],"y":[3885],"text":"count:  3885<br />C_CONF: 21<br />C_SEV: 1","type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"21","legendgroup":"21","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.05,"base":0,"x":[0.925],"y":[1925],"text":"count:  1925<br />C_CONF: 22<br />C_SEV: 1","type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,191,116,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"22","legendgroup":"22","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.05,"base":0,"x":[0.975],"y":[486],"text":"count:   486<br />C_CONF: 23<br />C_SEV: 1","type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,193,159,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"23","legendgroup":"23","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.0499999999999999,"base":0,"x":[1.025],"y":[215],"text":"count:   215<br />C_CONF: 24<br />C_SEV: 1","type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"24","legendgroup":"24","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.0499999999999998,"base":0,"x":[1.075],"y":[46],"text":"count:    46<br />C_CONF: 25<br />C_SEV: 1","type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,185,227,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"25","legendgroup":"25","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.0499999999999998,"base":0,"x":[1.125],"y":[14879],"text":"count: 14879<br />C_CONF: 31<br />C_SEV: 1","type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,173,250,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"31","legendgroup":"31","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.0499999999999998,"base":0,"x":[1.175],"y":[931],"text":"count:   931<br />C_CONF: 32<br />C_SEV: 1","type":"bar","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"32","legendgroup":"32","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.0499999999999998,"base":0,"x":[1.225],"y":[2628],"text":"count:  2628<br />C_CONF: 33<br />C_SEV: 1","type":"bar","marker":{"autocolorscale":false,"color":"rgba(174,135,255,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"33","legendgroup":"33","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.0499999999999998,"base":0,"x":[1.275],"y":[472],"text":"count:   472<br />C_CONF: 34<br />C_SEV: 1","type":"bar","marker":{"autocolorscale":false,"color":"rgba(219,114,251,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"34","legendgroup":"34","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.0499999999999998,"base":0,"x":[1.325],"y":[7848],"text":"count:  7848<br />C_CONF: 35<br />C_SEV: 1","type":"bar","marker":{"autocolorscale":false,"color":"rgba(245,100,227,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"35","legendgroup":"35","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.0499999999999998,"base":0,"x":[1.375],"y":[2131],"text":"count:  2131<br />C_CONF: 36<br />C_SEV: 1","type":"bar","marker":{"autocolorscale":false,"color":"rgba(255,97,195,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"36","legendgroup":"36","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.0499999999999998,"base":0,"x":[1.425],"y":[507],"text":"count:   507<br />C_CONF: 41<br />C_SEV: 1","type":"bar","marker":{"autocolorscale":false,"color":"rgba(255,105,156,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"41","legendgroup":"41","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.7108066971081,"r":7.30593607305936,"b":42.130898021309,"l":60.6392694063927},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Collision configuration for severe accidents","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,1.6],"tickmode":"array","ticktext":["1"],"tickvals":[1],"categoryorder":"array","categoryarray":["1"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"C_SEV","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-743.95,15622.95],"tickmode":"array","ticktext":["0","5,000","10,000","15,000"],"tickvals":[0,5000,10000,15000],"categoryorder":"array","categoryarray":["0","5,000","10,000","15,000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.963910761154856},"annotations":[{"text":"C_CONF","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"40143365a9b":{"fill":{},"x":{},"type":"bar"}},"cur_data":"40143365a9b","visdat":{"40143365a9b":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>ggplotly(ggplot(subset(acc_clean, C_SEV == &quot;2&quot;), aes(C_SEV)) +
  geom_bar(aes(fill = C_CONF), stat = &quot;count&quot;, color = &quot;black&quot;, 
           position = &quot;dodge&quot;) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle(&quot;Collision configuration for non-severe accidents&quot;) +
  theme_minimal())</code></pre>
<p><div id="htmlwidget-5" style="width:720px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-5">{"x":{"data":[{"orientation":"v","width":0.05,"base":0,"x":[0.575],"y":[31473],"text":"count:   31473<br />C_CONF: 01<br />C_SEV: 2","type":"bar","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"01","legendgroup":"01","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.05,"base":0,"x":[0.625],"y":[68928],"text":"count:   68928<br />C_CONF: 02<br />C_SEV: 2","type":"bar","marker":{"autocolorscale":false,"color":"rgba(232,133,38,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"02","legendgroup":"02","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.05,"base":0,"x":[0.675],"y":[85020],"text":"count:   85020<br />C_CONF: 03<br />C_SEV: 2","type":"bar","marker":{"autocolorscale":false,"color":"rgba(211,146,0,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"03","legendgroup":"03","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.05,"base":0,"x":[0.725],"y":[111568],"text":"count:  111568<br />C_CONF: 04<br />C_SEV: 2","type":"bar","marker":{"autocolorscale":false,"color":"rgba(183,159,0,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"04","legendgroup":"04","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.05,"base":0,"x":[0.775],"y":[7300],"text":"count:    7300<br />C_CONF: 05<br />C_SEV: 2","type":"bar","marker":{"autocolorscale":false,"color":"rgba(147,170,0,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"05","legendgroup":"05","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.05,"base":0,"x":[0.825],"y":[289050],"text":"count:  289050<br />C_CONF: 06<br />C_SEV: 2","type":"bar","marker":{"autocolorscale":false,"color":"rgba(94,179,0,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"06","legendgroup":"06","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.05,"base":0,"x":[0.875],"y":[1138694],"text":"count: 1138694<br />C_CONF: 21<br />C_SEV: 2","type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"21","legendgroup":"21","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.05,"base":0,"x":[0.925],"y":[133391],"text":"count:  133391<br />C_CONF: 22<br />C_SEV: 2","type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,191,116,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"22","legendgroup":"22","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.05,"base":0,"x":[0.975],"y":[33626],"text":"count:   33626<br />C_CONF: 23<br />C_SEV: 2","type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,193,159,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"23","legendgroup":"23","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.0499999999999999,"base":0,"x":[1.025],"y":[24576],"text":"count:   24576<br />C_CONF: 24<br />C_SEV: 2","type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"24","legendgroup":"24","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.0499999999999998,"base":0,"x":[1.075],"y":[4730],"text":"count:    4730<br />C_CONF: 25<br />C_SEV: 2","type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,185,227,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"25","legendgroup":"25","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.0499999999999998,"base":0,"x":[1.125],"y":[112128],"text":"count:  112128<br />C_CONF: 31<br />C_SEV: 2","type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,173,250,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"31","legendgroup":"31","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.0499999999999998,"base":0,"x":[1.175],"y":[20387],"text":"count:   20387<br />C_CONF: 32<br />C_SEV: 2","type":"bar","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"32","legendgroup":"32","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.0499999999999998,"base":0,"x":[1.225],"y":[250242],"text":"count:  250242<br />C_CONF: 33<br />C_SEV: 2","type":"bar","marker":{"autocolorscale":false,"color":"rgba(174,135,255,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"33","legendgroup":"33","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.0499999999999998,"base":0,"x":[1.275],"y":[38543],"text":"count:   38543<br />C_CONF: 34<br />C_SEV: 2","type":"bar","marker":{"autocolorscale":false,"color":"rgba(219,114,251,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"34","legendgroup":"34","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.0499999999999998,"base":0,"x":[1.325],"y":[527581],"text":"count:  527581<br />C_CONF: 35<br />C_SEV: 2","type":"bar","marker":{"autocolorscale":false,"color":"rgba(245,100,227,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"35","legendgroup":"35","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.0499999999999998,"base":0,"x":[1.375],"y":[338219],"text":"count:  338219<br />C_CONF: 36<br />C_SEV: 2","type":"bar","marker":{"autocolorscale":false,"color":"rgba(255,97,195,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"36","legendgroup":"36","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.0499999999999998,"base":0,"x":[1.425],"y":[25993],"text":"count:   25993<br />C_CONF: 41<br />C_SEV: 2","type":"bar","marker":{"autocolorscale":false,"color":"rgba(255,105,156,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"41","legendgroup":"41","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.7108066971081,"r":7.30593607305936,"b":42.130898021309,"l":66.4840182648402},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Collision configuration for non-severe accidents","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,1.6],"tickmode":"array","ticktext":["2"],"tickvals":[1],"categoryorder":"array","categoryarray":["2"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"C_SEV","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-56934.7,1195628.7],"tickmode":"array","ticktext":["0","300,000","600,000","900,000"],"tickvals":[0,300000,600000,900000],"categoryorder":"array","categoryarray":["0","300,000","600,000","900,000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.963910761154856},"annotations":[{"text":"C_CONF","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"4014257c3afd":{"fill":{},"x":{},"type":"bar"}},"cur_data":"4014257c3afd","visdat":{"4014257c3afd":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
Over 90% of all accidents during the 16 year period took place at either a non-intersection or an intersection of at least two public roadways.</p>
<pre class="r"><code>#roadway configuration with accident number

ggplotly(ggplot(acc_clean, aes(C_RCFG)) +
  geom_bar(stat = &quot;count&quot;, color = &quot;black&quot;, fill = &quot;gray66&quot;,
           position = &quot;dodge&quot;) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle(&quot;Number of accidents by roadway configuration&quot;) +
  theme_minimal())</code></pre>
<p><div id="htmlwidget-6" style="width:720px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-6">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999],"base":[0,0,0,0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7,8,9,10],"y":[1298140,1747870,197566,10518,30095,3782,317,6009,828,214],"text":["count: 1298140<br />C_RCFG: 01","count: 1747870<br />C_RCFG: 02","count:  197566<br />C_RCFG: 03","count:   10518<br />C_RCFG: 04","count:   30095<br />C_RCFG: 05","count:    3782<br />C_RCFG: 06","count:     317<br />C_RCFG: 07","count:    6009<br />C_RCFG: 08","count:     828<br />C_RCFG: 09","count:     214<br />C_RCFG: 10"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(168,168,168,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.7108066971081,"r":7.30593607305936,"b":42.130898021309,"l":78.1735159817352},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Number of accidents by roadway configuration","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,10.6],"tickmode":"array","ticktext":["01","02","03","04","05","06","07","08","09","10"],"tickvals":[1,2,3,4,5,6,7,8,9,10],"categoryorder":"array","categoryarray":["01","02","03","04","05","06","07","08","09","10"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"C_RCFG","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-87393.5,1835263.5],"tickmode":"array","ticktext":["0","500,000","1,000,000","1,500,000"],"tickvals":[0,500000,1000000,1500000],"categoryorder":"array","categoryarray":["0","500,000","1,000,000","1,500,000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"4014ead5068":{"x":{},"type":"bar"}},"cur_data":"4014ead5068","visdat":{"4014ead5068":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
Before jumping to hasty conclusions that accidents are caused due to clear and sunny days, it should be noted that a large number of accidents taking place during clear and sunny weather is probably because such weather is the most common throughout the year, thus naturally showing a higher number of accidents as well. The table showing the number of accidents by road surface condition shows a similar distribution to the weather condition chart, implying that there may be a correlation or association between these two variables. This will be explored further on.</p>
<pre class="r"><code>#weather and accident severity

ggplotly(ggplot(acc_clean, aes(C_WTHR)) +
  geom_bar(aes(fill = C_SEV), stat = &quot;count&quot;, color = &quot;black&quot;) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle(&quot;Weather and accident severity&quot;) +
  scale_fill_manual(values = c(&quot;red&quot;, &quot;slategray1&quot;)) +
  theme_minimal())</code></pre>
<div id="htmlwidget-7" style="width:720px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-7">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9],"base":[2305942,302117,366921,195135,17329,45963,8042],"x":[1,2,3,4,5,6,7],"y":[36744,6217,4444,3769,456,1987,273],"text":["count:   36744<br />C_SEV: 1<br />C_WTHR: 1","count:    6217<br />C_SEV: 1<br />C_WTHR: 2","count:    4444<br />C_SEV: 1<br />C_WTHR: 3","count:    3769<br />C_SEV: 1<br />C_WTHR: 4","count:     456<br />C_SEV: 1<br />C_WTHR: 5","count:    1987<br />C_SEV: 1<br />C_WTHR: 6","count:     273<br />C_SEV: 1<br />C_WTHR: 7"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9],"base":[0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7],"y":[2305942,302117,366921,195135,17329,45963,8042],"text":["count: 2305942<br />C_SEV: 2<br />C_WTHR: 1","count:  302117<br />C_SEV: 2<br />C_WTHR: 2","count:  366921<br />C_SEV: 2<br />C_WTHR: 3","count:  195135<br />C_SEV: 2<br />C_WTHR: 4","count:   17329<br />C_SEV: 2<br />C_WTHR: 5","count:   45963<br />C_SEV: 2<br />C_WTHR: 6","count:    8042<br />C_SEV: 2<br />C_WTHR: 7"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(198,226,255,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.7108066971081,"r":7.30593607305936,"b":42.130898021309,"l":78.1735159817352},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Weather and accident severity","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,7.6],"tickmode":"array","ticktext":["1","2","3","4","5","6","7"],"tickvals":[1,2,3,4,5,6,7],"categoryorder":"array","categoryarray":["1","2","3","4","5","6","7"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"C_WTHR","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-117134.3,2459820.3],"tickmode":"array","ticktext":["0","500,000","1,000,000","1,500,000","2,000,000"],"tickvals":[0,500000,1000000,1500000,2000000],"categoryorder":"array","categoryarray":["0","500,000","1,000,000","1,500,000","2,000,000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.963910761154856},"annotations":[{"text":"C_SEV","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"401414e9591c":{"fill":{},"x":{},"type":"bar"}},"cur_data":"401414e9591c","visdat":{"401414e9591c":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>#road surface and accident severity

table(C_SEV = acc_clean$C_SEV, C_RSUR = acc_clean$C_RSUR)</code></pre>
<pre><code>##      C_RSUR
## C_SEV       1       2       3       4       5       6       7       8
##     1   36902    8651    2932     994    3654     655      97       3
##     2 2197851  655544  146694   46192  177835   13926    2652     624
##      C_RSUR
## C_SEV       9
##     1       2
##     2     131</code></pre>
<p>An interesting observation from the below chart shows that most of the accidents either took place where there was no control present at all, or where there were fully operational traffic signals, or a stop sign. These categories can be considered as two extreme opposites to each other, yet both combined have the highest number of accidents attributed to them.</p>
<pre class="r"><code>#traffic control and accident severity

ggplotly(ggplot(acc_clean, aes(C_TRAF)) +
  geom_bar(stat = &quot;count&quot;, color = &quot;black&quot;, fill = &quot;gray66&quot;,
           position = &quot;dodge&quot;) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle(&quot;Number of accidents by traffic control&quot;) +
  theme_minimal())</code></pre>
<p><div id="htmlwidget-8" style="width:720px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-8">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],"y":[1012167,11985,407536,37670,2010,15094,1368,15411,200,1285,1338,1853,3142,1953,437,635,1781255],"text":["count: 1012167<br />C_TRAF: 01","count:   11985<br />C_TRAF: 02","count:  407536<br />C_TRAF: 03","count:   37670<br />C_TRAF: 04","count:    2010<br />C_TRAF: 05","count:   15094<br />C_TRAF: 06","count:    1368<br />C_TRAF: 07","count:   15411<br />C_TRAF: 08","count:     200<br />C_TRAF: 09","count:    1285<br />C_TRAF: 10","count:    1338<br />C_TRAF: 11","count:    1853<br />C_TRAF: 12","count:    3142<br />C_TRAF: 13","count:    1953<br />C_TRAF: 15","count:     437<br />C_TRAF: 16","count:     635<br />C_TRAF: 17","count: 1781255<br />C_TRAF: 18"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(168,168,168,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.7108066971081,"r":7.30593607305936,"b":42.130898021309,"l":78.1735159817352},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Number of accidents by traffic control","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,17.6],"tickmode":"array","ticktext":["01","02","03","04","05","06","07","08","09","10","11","12","13","15","16","17","18"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],"categoryorder":"array","categoryarray":["01","02","03","04","05","06","07","08","09","10","11","12","13","15","16","17","18"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"C_TRAF","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-89062.75,1870317.75],"tickmode":"array","ticktext":["0","500,000","1,000,000","1,500,000"],"tickvals":[0,500000,1000000,1500000],"categoryorder":"array","categoryarray":["0","500,000","1,000,000","1,500,000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"40141ff20d6":{"x":{},"type":"bar"}},"cur_data":"40141ff20d6","visdat":{"40141ff20d6":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
To clearly show how severity of accidents vary by vehicle type, percentages instead of absolute numbers are used in the below chart. Here it can be seen that the highest percentage of severe accidents took place when the vehicle type was either a road tractor, a purpose built motorhome, a heavy unit truck or motorcycles and mopeds.</p>
<pre class="r"><code>#vehicle type and accident severity

ggplotly(ggplot(acc_clean, aes(V_TYPE)) +
  geom_bar(aes(fill = C_SEV), stat = &quot;count&quot;, color = &quot;black&quot;,
           position = &quot;fill&quot;) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle(&quot;Percentage severity by vehicle type&quot;) +
  scale_fill_manual(values = c(&quot;red&quot;, &quot;slategray1&quot;)) +
  theme_minimal())</code></pre>
<p><div id="htmlwidget-9" style="width:720px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999],"base":[0.985447602771015,0.983965517241379,0.978033625375587,0.958090038168904,0.927169251072253,0.963260340632603,0.996965098634294,0.971842725131364,0.961571174514807,0.994899693981639,0.940268456375839,0.97508896797153,0.992921492921493],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13],"y":[0.0145523972289849,0.0160344827586207,0.0219663746244129,0.0419099618310963,0.0728307489277467,0.0367396593673966,0.00303490136570561,0.0281572748686356,0.0384288254851929,0.00510030601836109,0.0597315436241611,0.0249110320284698,0.0070785070785071],"text":["count: 0.014552397<br />C_SEV: 1<br />V_TYPE: 01","count: 0.016034483<br />C_SEV: 1<br />V_TYPE: 05","count: 0.021966375<br />C_SEV: 1<br />V_TYPE: 06","count: 0.041909962<br />C_SEV: 1<br />V_TYPE: 07","count: 0.072830749<br />C_SEV: 1<br />V_TYPE: 08","count: 0.036739659<br />C_SEV: 1<br />V_TYPE: 09","count: 0.003034901<br />C_SEV: 1<br />V_TYPE: 10","count: 0.028157275<br />C_SEV: 1<br />V_TYPE: 11","count: 0.038428825<br />C_SEV: 1<br />V_TYPE: 14","count: 0.005100306<br />C_SEV: 1<br />V_TYPE: 17","count: 0.059731544<br />C_SEV: 1<br />V_TYPE: 18","count: 0.024911032<br />C_SEV: 1<br />V_TYPE: 21","count: 0.007078507<br />C_SEV: 1<br />V_TYPE: 23"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13],"y":[0.985447602771015,0.983965517241379,0.978033625375587,0.958090038168904,0.927169251072253,0.963260340632603,0.996965098634294,0.971842725131364,0.961571174514807,0.994899693981639,0.940268456375839,0.97508896797153,0.992921492921493],"text":["count: 0.985447603<br />C_SEV: 2<br />V_TYPE: 01","count: 0.983965517<br />C_SEV: 2<br />V_TYPE: 05","count: 0.978033625<br />C_SEV: 2<br />V_TYPE: 06","count: 0.958090038<br />C_SEV: 2<br />V_TYPE: 07","count: 0.927169251<br />C_SEV: 2<br />V_TYPE: 08","count: 0.963260341<br />C_SEV: 2<br />V_TYPE: 09","count: 0.996965099<br />C_SEV: 2<br />V_TYPE: 10","count: 0.971842725<br />C_SEV: 2<br />V_TYPE: 11","count: 0.961571175<br />C_SEV: 2<br />V_TYPE: 14","count: 0.994899694<br />C_SEV: 2<br />V_TYPE: 17","count: 0.940268456<br />C_SEV: 2<br />V_TYPE: 18","count: 0.975088968<br />C_SEV: 2<br />V_TYPE: 21","count: 0.992921493<br />C_SEV: 2<br />V_TYPE: 23"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(198,226,255,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.7108066971081,"r":7.30593607305936,"b":42.130898021309,"l":48.9497716894977},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Percentage severity by vehicle type","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,13.6],"tickmode":"array","ticktext":["01","05","06","07","08","09","10","11","14","17","18","21","23"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13],"categoryorder":"array","categoryarray":["01","05","06","07","08","09","10","11","14","17","18","21","23"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"V_TYPE","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.05,1.05],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.963910761154856},"annotations":[{"text":"C_SEV","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"401446f4530e":{"fill":{},"x":{},"type":"bar"}},"cur_data":"401446f4530e","visdat":{"401446f4530e":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
Men tend to have more accidents (and a higher percentage of severe accidents) than women, according to the data. This does not automatically imply that men are worse drivers. It could also simply be because there may be more men drivers than women in general, or that more men tend to operate dangerous vehicles than women.</p>
<pre class="r"><code>#sex and accident severity

ggplotly(ggplot(acc_clean, aes(P_SEX)) +
  geom_bar(aes(fill = C_SEV), stat = &quot;count&quot;, color = &quot;black&quot;) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle(&quot;Number of accidents distributed between men and women&quot;) +
  scale_fill_manual(values = c(&quot;red&quot;, &quot;slategray1&quot;)) +
  theme_minimal())</code></pre>
<p><div id="htmlwidget-10" style="width:720px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-10">{"x":{"data":[{"orientation":"v","width":[0.9,0.9],"base":[1500647,1740802],"x":[1,2],"y":[18318,35572],"text":["count:   18318<br />C_SEV: 1<br />P_SEX: F","count:   35572<br />C_SEV: 1<br />P_SEX: M"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[0,0],"x":[1,2],"y":[1500647,1740802],"text":["count: 1500647<br />C_SEV: 2<br />P_SEX: F","count: 1740802<br />C_SEV: 2<br />P_SEX: M"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(198,226,255,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.7108066971081,"r":7.30593607305936,"b":42.130898021309,"l":78.1735159817352},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Number of accidents distributed between men and women","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,2.6],"tickmode":"array","ticktext":["F","M"],"tickvals":[1,2],"categoryorder":"array","categoryarray":["F","M"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"P_SEX","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-88818.7,1865192.7],"tickmode":"array","ticktext":["0","500,000","1,000,000","1,500,000"],"tickvals":[0,500000,1000000,1500000],"categoryorder":"array","categoryarray":["0","500,000","1,000,000","1,500,000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.963910761154856},"annotations":[{"text":"C_SEV","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"401453d93dcc":{"fill":{},"x":{},"type":"bar"}},"cur_data":"401453d93dcc","visdat":{"401453d93dcc":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
Naturally, the largest spike in the number of accidents is around the age of 17 and 18, which is when people tend to get their new driving license. As age increases, the number of accidents decreases, which can be because of more experience gained while driving, and towards later ages when people tend to drive less and less the older they get. The percentage of severity (class 3 - red) however tends to remain constant throughout all ages, only rising when the age is 80 and above.</p>
<pre class="r"><code>#age and medical treatment required

ggplotly(ggplot(acc_clean, aes(P_AGE)) +
  geom_bar(aes(fill = P_ISEV), stat = &quot;count&quot;) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle(&quot;Medical treatment by age (absolute numbers)&quot;) +
  scale_fill_manual(values = c(&quot;limegreen&quot;, &quot;paleturquoise2&quot;,&quot;red&quot;)) +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.ticks.x = element_blank()))</code></pre>
<div id="htmlwidget-11" style="width:720px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-11">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.900000000000002,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006],"base":[8151,5011,5580,6295,6647,6820,7223,7529,7701,8129,7923,7994,8444,10509,15080,30534,55487,61768,60412,56904,52745,49316,46482,43689,41881,39243,37632,36371,34717,34648,32689,32792,32304,32049,32510,32202,32319,32485,32708,33745,32641,32969,32376,32289,31906,30897,30132,30003,29175,28582,27252,26538,25153,24171,22845,21601,20256,18893,17945,17266,15191,14432,13816,13009,12323,11123,10592,9790,9622,9402,8540,8585,7870,7778,7606,7054,6645,6289,5889,5694,4652,4337,3789,3227,2795,2309,1850,1368,1081,817,549,392,274,174,91,78,41,67,65],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[21073,13173,12713,12270,11748,10528,10224,10050,9845,10009,9595,9633,9457,10553,12843,23037,40988,43161,41108,38073,35274,32935,31210,29099,28359,26257,25533,24595,23841,24622,23081,23005,23033,23265,24231,23772,23592,23948,24116,25010,23899,24483,24281,23437,23873,22529,21941,21386,20694,20500,19181,18588,17938,16864,16168,15029,14287,13673,12775,12397,11057,10570,10095,9497,9116,8102,7637,7286,6738,6743,6209,6098,5706,5419,5094,4906,4449,4180,3882,3639,3049,2754,2465,2041,1730,1364,1090,812,579,482,316,236,143,86,63,40,23,31,66],"text":["count: 21073<br />P_ISEV: 1<br />P_AGE: 01","count: 13173<br />P_ISEV: 1<br />P_AGE: 02","count: 12713<br />P_ISEV: 1<br />P_AGE: 03","count: 12270<br />P_ISEV: 1<br />P_AGE: 04","count: 11748<br />P_ISEV: 1<br />P_AGE: 05","count: 10528<br />P_ISEV: 1<br />P_AGE: 06","count: 10224<br />P_ISEV: 1<br />P_AGE: 07","count: 10050<br />P_ISEV: 1<br />P_AGE: 08","count:  9845<br />P_ISEV: 1<br />P_AGE: 09","count: 10009<br />P_ISEV: 1<br />P_AGE: 10","count:  9595<br />P_ISEV: 1<br />P_AGE: 11","count:  9633<br />P_ISEV: 1<br />P_AGE: 12","count:  9457<br />P_ISEV: 1<br />P_AGE: 13","count: 10553<br />P_ISEV: 1<br />P_AGE: 14","count: 12843<br />P_ISEV: 1<br />P_AGE: 15","count: 23037<br />P_ISEV: 1<br />P_AGE: 16","count: 40988<br />P_ISEV: 1<br />P_AGE: 17","count: 43161<br />P_ISEV: 1<br />P_AGE: 18","count: 41108<br />P_ISEV: 1<br />P_AGE: 19","count: 38073<br />P_ISEV: 1<br />P_AGE: 20","count: 35274<br />P_ISEV: 1<br />P_AGE: 21","count: 32935<br />P_ISEV: 1<br />P_AGE: 22","count: 31210<br />P_ISEV: 1<br />P_AGE: 23","count: 29099<br />P_ISEV: 1<br />P_AGE: 24","count: 28359<br />P_ISEV: 1<br />P_AGE: 25","count: 26257<br />P_ISEV: 1<br />P_AGE: 26","count: 25533<br />P_ISEV: 1<br />P_AGE: 27","count: 24595<br />P_ISEV: 1<br />P_AGE: 28","count: 23841<br />P_ISEV: 1<br />P_AGE: 29","count: 24622<br />P_ISEV: 1<br />P_AGE: 30","count: 23081<br />P_ISEV: 1<br />P_AGE: 31","count: 23005<br />P_ISEV: 1<br />P_AGE: 32","count: 23033<br />P_ISEV: 1<br />P_AGE: 33","count: 23265<br />P_ISEV: 1<br />P_AGE: 34","count: 24231<br />P_ISEV: 1<br />P_AGE: 35","count: 23772<br />P_ISEV: 1<br />P_AGE: 36","count: 23592<br />P_ISEV: 1<br />P_AGE: 37","count: 23948<br />P_ISEV: 1<br />P_AGE: 38","count: 24116<br />P_ISEV: 1<br />P_AGE: 39","count: 25010<br />P_ISEV: 1<br />P_AGE: 40","count: 23899<br />P_ISEV: 1<br />P_AGE: 41","count: 24483<br />P_ISEV: 1<br />P_AGE: 42","count: 24281<br />P_ISEV: 1<br />P_AGE: 43","count: 23437<br />P_ISEV: 1<br />P_AGE: 44","count: 23873<br />P_ISEV: 1<br />P_AGE: 45","count: 22529<br />P_ISEV: 1<br />P_AGE: 46","count: 21941<br />P_ISEV: 1<br />P_AGE: 47","count: 21386<br />P_ISEV: 1<br />P_AGE: 48","count: 20694<br />P_ISEV: 1<br />P_AGE: 49","count: 20500<br />P_ISEV: 1<br />P_AGE: 50","count: 19181<br />P_ISEV: 1<br />P_AGE: 51","count: 18588<br />P_ISEV: 1<br />P_AGE: 52","count: 17938<br />P_ISEV: 1<br />P_AGE: 53","count: 16864<br />P_ISEV: 1<br />P_AGE: 54","count: 16168<br />P_ISEV: 1<br />P_AGE: 55","count: 15029<br />P_ISEV: 1<br />P_AGE: 56","count: 14287<br />P_ISEV: 1<br />P_AGE: 57","count: 13673<br />P_ISEV: 1<br />P_AGE: 58","count: 12775<br />P_ISEV: 1<br />P_AGE: 59","count: 12397<br />P_ISEV: 1<br />P_AGE: 60","count: 11057<br />P_ISEV: 1<br />P_AGE: 61","count: 10570<br />P_ISEV: 1<br />P_AGE: 62","count: 10095<br />P_ISEV: 1<br />P_AGE: 63","count:  9497<br />P_ISEV: 1<br />P_AGE: 64","count:  9116<br />P_ISEV: 1<br />P_AGE: 65","count:  8102<br />P_ISEV: 1<br />P_AGE: 66","count:  7637<br />P_ISEV: 1<br />P_AGE: 67","count:  7286<br />P_ISEV: 1<br />P_AGE: 68","count:  6738<br />P_ISEV: 1<br />P_AGE: 69","count:  6743<br />P_ISEV: 1<br />P_AGE: 70","count:  6209<br />P_ISEV: 1<br />P_AGE: 71","count:  6098<br />P_ISEV: 1<br />P_AGE: 72","count:  5706<br />P_ISEV: 1<br />P_AGE: 73","count:  5419<br />P_ISEV: 1<br />P_AGE: 74","count:  5094<br />P_ISEV: 1<br />P_AGE: 75","count:  4906<br />P_ISEV: 1<br />P_AGE: 76","count:  4449<br />P_ISEV: 1<br />P_AGE: 77","count:  4180<br />P_ISEV: 1<br />P_AGE: 78","count:  3882<br />P_ISEV: 1<br />P_AGE: 79","count:  3639<br />P_ISEV: 1<br />P_AGE: 80","count:  3049<br />P_ISEV: 1<br />P_AGE: 81","count:  2754<br />P_ISEV: 1<br />P_AGE: 82","count:  2465<br />P_ISEV: 1<br />P_AGE: 83","count:  2041<br />P_ISEV: 1<br />P_AGE: 84","count:  1730<br />P_ISEV: 1<br />P_AGE: 85","count:  1364<br />P_ISEV: 1<br />P_AGE: 86","count:  1090<br />P_ISEV: 1<br />P_AGE: 87","count:   812<br />P_ISEV: 1<br />P_AGE: 88","count:   579<br />P_ISEV: 1<br />P_AGE: 89","count:   482<br />P_ISEV: 1<br />P_AGE: 90","count:   316<br />P_ISEV: 1<br />P_AGE: 91","count:   236<br />P_ISEV: 1<br />P_AGE: 92","count:   143<br />P_ISEV: 1<br />P_AGE: 93","count:    86<br />P_ISEV: 1<br />P_AGE: 94","count:    63<br />P_ISEV: 1<br />P_AGE: 95","count:    40<br />P_ISEV: 1<br />P_AGE: 96","count:    23<br />P_ISEV: 1<br />P_AGE: 97","count:    31<br />P_ISEV: 1<br />P_AGE: 98","count:    66<br />P_ISEV: 1<br />P_AGE: 99"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(50,205,50,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.900000000000002,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006],"base":[72,25,22,31,22,33,44,37,46,45,53,51,53,71,145,369,611,719,754,700,636,590,496,469,442,407,366,332,337,312,291,292,282,277,297,249,275,316,280,302,295,315,297,282,299,285,292,315,330,288,296,268,284,276,254,258,248,229,220,231,192,176,226,191,172,142,165,157,175,175,158,163,166,163,159,172,158,155,155,154,155,128,125,111,106,92,86,54,40,42,34,21,18,14,6,4,1,0,1],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[8079,4986,5558,6264,6625,6787,7179,7492,7655,8084,7870,7943,8391,10438,14935,30165,54876,61049,59658,56204,52109,48726,45986,43220,41439,38836,37266,36039,34380,34336,32398,32500,32022,31772,32213,31953,32044,32169,32428,33443,32346,32654,32079,32007,31607,30612,29840,29688,28845,28294,26956,26270,24869,23895,22591,21343,20008,18664,17725,17035,14999,14256,13590,12818,12151,10981,10427,9633,9447,9227,8382,8422,7704,7615,7447,6882,6487,6134,5734,5540,4497,4209,3664,3116,2689,2217,1764,1314,1041,775,515,371,256,160,85,74,40,67,64],"text":["count:  8079<br />P_ISEV: 2<br />P_AGE: 01","count:  4986<br />P_ISEV: 2<br />P_AGE: 02","count:  5558<br />P_ISEV: 2<br />P_AGE: 03","count:  6264<br />P_ISEV: 2<br />P_AGE: 04","count:  6625<br />P_ISEV: 2<br />P_AGE: 05","count:  6787<br />P_ISEV: 2<br />P_AGE: 06","count:  7179<br />P_ISEV: 2<br />P_AGE: 07","count:  7492<br />P_ISEV: 2<br />P_AGE: 08","count:  7655<br />P_ISEV: 2<br />P_AGE: 09","count:  8084<br />P_ISEV: 2<br />P_AGE: 10","count:  7870<br />P_ISEV: 2<br />P_AGE: 11","count:  7943<br />P_ISEV: 2<br />P_AGE: 12","count:  8391<br />P_ISEV: 2<br />P_AGE: 13","count: 10438<br />P_ISEV: 2<br />P_AGE: 14","count: 14935<br />P_ISEV: 2<br />P_AGE: 15","count: 30165<br />P_ISEV: 2<br />P_AGE: 16","count: 54876<br />P_ISEV: 2<br />P_AGE: 17","count: 61049<br />P_ISEV: 2<br />P_AGE: 18","count: 59658<br />P_ISEV: 2<br />P_AGE: 19","count: 56204<br />P_ISEV: 2<br />P_AGE: 20","count: 52109<br />P_ISEV: 2<br />P_AGE: 21","count: 48726<br />P_ISEV: 2<br />P_AGE: 22","count: 45986<br />P_ISEV: 2<br />P_AGE: 23","count: 43220<br />P_ISEV: 2<br />P_AGE: 24","count: 41439<br />P_ISEV: 2<br />P_AGE: 25","count: 38836<br />P_ISEV: 2<br />P_AGE: 26","count: 37266<br />P_ISEV: 2<br />P_AGE: 27","count: 36039<br />P_ISEV: 2<br />P_AGE: 28","count: 34380<br />P_ISEV: 2<br />P_AGE: 29","count: 34336<br />P_ISEV: 2<br />P_AGE: 30","count: 32398<br />P_ISEV: 2<br />P_AGE: 31","count: 32500<br />P_ISEV: 2<br />P_AGE: 32","count: 32022<br />P_ISEV: 2<br />P_AGE: 33","count: 31772<br />P_ISEV: 2<br />P_AGE: 34","count: 32213<br />P_ISEV: 2<br />P_AGE: 35","count: 31953<br />P_ISEV: 2<br />P_AGE: 36","count: 32044<br />P_ISEV: 2<br />P_AGE: 37","count: 32169<br />P_ISEV: 2<br />P_AGE: 38","count: 32428<br />P_ISEV: 2<br />P_AGE: 39","count: 33443<br />P_ISEV: 2<br />P_AGE: 40","count: 32346<br />P_ISEV: 2<br />P_AGE: 41","count: 32654<br />P_ISEV: 2<br />P_AGE: 42","count: 32079<br />P_ISEV: 2<br />P_AGE: 43","count: 32007<br />P_ISEV: 2<br />P_AGE: 44","count: 31607<br />P_ISEV: 2<br />P_AGE: 45","count: 30612<br />P_ISEV: 2<br />P_AGE: 46","count: 29840<br />P_ISEV: 2<br />P_AGE: 47","count: 29688<br />P_ISEV: 2<br />P_AGE: 48","count: 28845<br />P_ISEV: 2<br />P_AGE: 49","count: 28294<br />P_ISEV: 2<br />P_AGE: 50","count: 26956<br />P_ISEV: 2<br />P_AGE: 51","count: 26270<br />P_ISEV: 2<br />P_AGE: 52","count: 24869<br />P_ISEV: 2<br />P_AGE: 53","count: 23895<br />P_ISEV: 2<br />P_AGE: 54","count: 22591<br />P_ISEV: 2<br />P_AGE: 55","count: 21343<br />P_ISEV: 2<br />P_AGE: 56","count: 20008<br />P_ISEV: 2<br />P_AGE: 57","count: 18664<br />P_ISEV: 2<br />P_AGE: 58","count: 17725<br />P_ISEV: 2<br />P_AGE: 59","count: 17035<br />P_ISEV: 2<br />P_AGE: 60","count: 14999<br />P_ISEV: 2<br />P_AGE: 61","count: 14256<br />P_ISEV: 2<br />P_AGE: 62","count: 13590<br />P_ISEV: 2<br />P_AGE: 63","count: 12818<br />P_ISEV: 2<br />P_AGE: 64","count: 12151<br />P_ISEV: 2<br />P_AGE: 65","count: 10981<br />P_ISEV: 2<br />P_AGE: 66","count: 10427<br />P_ISEV: 2<br />P_AGE: 67","count:  9633<br />P_ISEV: 2<br />P_AGE: 68","count:  9447<br />P_ISEV: 2<br />P_AGE: 69","count:  9227<br />P_ISEV: 2<br />P_AGE: 70","count:  8382<br />P_ISEV: 2<br />P_AGE: 71","count:  8422<br />P_ISEV: 2<br />P_AGE: 72","count:  7704<br />P_ISEV: 2<br />P_AGE: 73","count:  7615<br />P_ISEV: 2<br />P_AGE: 74","count:  7447<br />P_ISEV: 2<br />P_AGE: 75","count:  6882<br />P_ISEV: 2<br />P_AGE: 76","count:  6487<br />P_ISEV: 2<br />P_AGE: 77","count:  6134<br />P_ISEV: 2<br />P_AGE: 78","count:  5734<br />P_ISEV: 2<br />P_AGE: 79","count:  5540<br />P_ISEV: 2<br />P_AGE: 80","count:  4497<br />P_ISEV: 2<br />P_AGE: 81","count:  4209<br />P_ISEV: 2<br />P_AGE: 82","count:  3664<br />P_ISEV: 2<br />P_AGE: 83","count:  3116<br />P_ISEV: 2<br />P_AGE: 84","count:  2689<br />P_ISEV: 2<br />P_AGE: 85","count:  2217<br />P_ISEV: 2<br />P_AGE: 86","count:  1764<br />P_ISEV: 2<br />P_AGE: 87","count:  1314<br />P_ISEV: 2<br />P_AGE: 88","count:  1041<br />P_ISEV: 2<br />P_AGE: 89","count:   775<br />P_ISEV: 2<br />P_AGE: 90","count:   515<br />P_ISEV: 2<br />P_AGE: 91","count:   371<br />P_ISEV: 2<br />P_AGE: 92","count:   256<br />P_ISEV: 2<br />P_AGE: 93","count:   160<br />P_ISEV: 2<br />P_AGE: 94","count:    85<br />P_ISEV: 2<br />P_AGE: 95","count:    74<br />P_ISEV: 2<br />P_AGE: 96","count:    40<br />P_ISEV: 2<br />P_AGE: 97","count:    67<br />P_ISEV: 2<br />P_AGE: 98","count:    64<br />P_ISEV: 2<br />P_AGE: 99"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(174,238,238,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.900000000000002,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,99],"y":[72,25,22,31,22,33,44,37,46,45,53,51,53,71,145,369,611,719,754,700,636,590,496,469,442,407,366,332,337,312,291,292,282,277,297,249,275,316,280,302,295,315,297,282,299,285,292,315,330,288,296,268,284,276,254,258,248,229,220,231,192,176,226,191,172,142,165,157,175,175,158,163,166,163,159,172,158,155,155,154,155,128,125,111,106,92,86,54,40,42,34,21,18,14,6,4,1,1],"text":["count:    72<br />P_ISEV: 3<br />P_AGE: 01","count:    25<br />P_ISEV: 3<br />P_AGE: 02","count:    22<br />P_ISEV: 3<br />P_AGE: 03","count:    31<br />P_ISEV: 3<br />P_AGE: 04","count:    22<br />P_ISEV: 3<br />P_AGE: 05","count:    33<br />P_ISEV: 3<br />P_AGE: 06","count:    44<br />P_ISEV: 3<br />P_AGE: 07","count:    37<br />P_ISEV: 3<br />P_AGE: 08","count:    46<br />P_ISEV: 3<br />P_AGE: 09","count:    45<br />P_ISEV: 3<br />P_AGE: 10","count:    53<br />P_ISEV: 3<br />P_AGE: 11","count:    51<br />P_ISEV: 3<br />P_AGE: 12","count:    53<br />P_ISEV: 3<br />P_AGE: 13","count:    71<br />P_ISEV: 3<br />P_AGE: 14","count:   145<br />P_ISEV: 3<br />P_AGE: 15","count:   369<br />P_ISEV: 3<br />P_AGE: 16","count:   611<br />P_ISEV: 3<br />P_AGE: 17","count:   719<br />P_ISEV: 3<br />P_AGE: 18","count:   754<br />P_ISEV: 3<br />P_AGE: 19","count:   700<br />P_ISEV: 3<br />P_AGE: 20","count:   636<br />P_ISEV: 3<br />P_AGE: 21","count:   590<br />P_ISEV: 3<br />P_AGE: 22","count:   496<br />P_ISEV: 3<br />P_AGE: 23","count:   469<br />P_ISEV: 3<br />P_AGE: 24","count:   442<br />P_ISEV: 3<br />P_AGE: 25","count:   407<br />P_ISEV: 3<br />P_AGE: 26","count:   366<br />P_ISEV: 3<br />P_AGE: 27","count:   332<br />P_ISEV: 3<br />P_AGE: 28","count:   337<br />P_ISEV: 3<br />P_AGE: 29","count:   312<br />P_ISEV: 3<br />P_AGE: 30","count:   291<br />P_ISEV: 3<br />P_AGE: 31","count:   292<br />P_ISEV: 3<br />P_AGE: 32","count:   282<br />P_ISEV: 3<br />P_AGE: 33","count:   277<br />P_ISEV: 3<br />P_AGE: 34","count:   297<br />P_ISEV: 3<br />P_AGE: 35","count:   249<br />P_ISEV: 3<br />P_AGE: 36","count:   275<br />P_ISEV: 3<br />P_AGE: 37","count:   316<br />P_ISEV: 3<br />P_AGE: 38","count:   280<br />P_ISEV: 3<br />P_AGE: 39","count:   302<br />P_ISEV: 3<br />P_AGE: 40","count:   295<br />P_ISEV: 3<br />P_AGE: 41","count:   315<br />P_ISEV: 3<br />P_AGE: 42","count:   297<br />P_ISEV: 3<br />P_AGE: 43","count:   282<br />P_ISEV: 3<br />P_AGE: 44","count:   299<br />P_ISEV: 3<br />P_AGE: 45","count:   285<br />P_ISEV: 3<br />P_AGE: 46","count:   292<br />P_ISEV: 3<br />P_AGE: 47","count:   315<br />P_ISEV: 3<br />P_AGE: 48","count:   330<br />P_ISEV: 3<br />P_AGE: 49","count:   288<br />P_ISEV: 3<br />P_AGE: 50","count:   296<br />P_ISEV: 3<br />P_AGE: 51","count:   268<br />P_ISEV: 3<br />P_AGE: 52","count:   284<br />P_ISEV: 3<br />P_AGE: 53","count:   276<br />P_ISEV: 3<br />P_AGE: 54","count:   254<br />P_ISEV: 3<br />P_AGE: 55","count:   258<br />P_ISEV: 3<br />P_AGE: 56","count:   248<br />P_ISEV: 3<br />P_AGE: 57","count:   229<br />P_ISEV: 3<br />P_AGE: 58","count:   220<br />P_ISEV: 3<br />P_AGE: 59","count:   231<br />P_ISEV: 3<br />P_AGE: 60","count:   192<br />P_ISEV: 3<br />P_AGE: 61","count:   176<br />P_ISEV: 3<br />P_AGE: 62","count:   226<br />P_ISEV: 3<br />P_AGE: 63","count:   191<br />P_ISEV: 3<br />P_AGE: 64","count:   172<br />P_ISEV: 3<br />P_AGE: 65","count:   142<br />P_ISEV: 3<br />P_AGE: 66","count:   165<br />P_ISEV: 3<br />P_AGE: 67","count:   157<br />P_ISEV: 3<br />P_AGE: 68","count:   175<br />P_ISEV: 3<br />P_AGE: 69","count:   175<br />P_ISEV: 3<br />P_AGE: 70","count:   158<br />P_ISEV: 3<br />P_AGE: 71","count:   163<br />P_ISEV: 3<br />P_AGE: 72","count:   166<br />P_ISEV: 3<br />P_AGE: 73","count:   163<br />P_ISEV: 3<br />P_AGE: 74","count:   159<br />P_ISEV: 3<br />P_AGE: 75","count:   172<br />P_ISEV: 3<br />P_AGE: 76","count:   158<br />P_ISEV: 3<br />P_AGE: 77","count:   155<br />P_ISEV: 3<br />P_AGE: 78","count:   155<br />P_ISEV: 3<br />P_AGE: 79","count:   154<br />P_ISEV: 3<br />P_AGE: 80","count:   155<br />P_ISEV: 3<br />P_AGE: 81","count:   128<br />P_ISEV: 3<br />P_AGE: 82","count:   125<br />P_ISEV: 3<br />P_AGE: 83","count:   111<br />P_ISEV: 3<br />P_AGE: 84","count:   106<br />P_ISEV: 3<br />P_AGE: 85","count:    92<br />P_ISEV: 3<br />P_AGE: 86","count:    86<br />P_ISEV: 3<br />P_AGE: 87","count:    54<br />P_ISEV: 3<br />P_AGE: 88","count:    40<br />P_ISEV: 3<br />P_AGE: 89","count:    42<br />P_ISEV: 3<br />P_AGE: 90","count:    34<br />P_ISEV: 3<br />P_AGE: 91","count:    21<br />P_ISEV: 3<br />P_AGE: 92","count:    18<br />P_ISEV: 3<br />P_AGE: 93","count:    14<br />P_ISEV: 3<br />P_AGE: 94","count:     6<br />P_ISEV: 3<br />P_AGE: 95","count:     4<br />P_ISEV: 3<br />P_AGE: 96","count:     1<br />P_ISEV: 3<br />P_AGE: 97","count:     1<br />P_ISEV: 3<br />P_AGE: 99"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.7108066971081,"r":7.30593607305936,"b":30.441400304414,"l":66.4840182648402},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Medical treatment by age (absolute numbers)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,99.6],"tickmode":"array","ticktext":["01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"categoryorder":"array","categoryarray":["01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"P_AGE","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-5246.45,110175.45],"tickmode":"array","ticktext":["0","25,000","50,000","75,000","100,000"],"tickvals":[0,25000,50000,75000,100000],"categoryorder":"array","categoryarray":["0","25,000","50,000","75,000","100,000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.963910761154856},"annotations":[{"text":"P_ISEV","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"401416833f5":{"fill":{},"x":{},"type":"bar"}},"cur_data":"401416833f5","visdat":{"401416833f5":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>ggplotly(ggplot(acc_clean, aes(P_AGE)) +
  geom_bar(aes(fill = P_ISEV), stat = &quot;count&quot;,
           position = &quot;fill&quot;) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle(&quot;Medical treatment by age (percentage)&quot;) +
  scale_fill_manual(values = c(&quot;limegreen&quot;, &quot;paleturquoise2&quot;,&quot;red&quot;)) +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.ticks.x = element_blank()))</code></pre>
<p><div id="htmlwidget-12" style="width:720px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-12">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.900000000000002,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006],"base":[0.278914590747331,0.275571931368236,0.305034712731646,0.339078911931053,0.361348192443599,0.393128890938437,0.413996675646243,0.428295124864896,0.438903453778639,0.44817510199581,0.452277657266811,0.453508821693992,0.471705491313334,0.498955464818156,0.540056584177918,0.569972559780478,0.575143819642394,0.588664716141391,0.595074862096139,0.599134527306611,0.599245617423511,0.599579336421442,0.598285537764506,0.600222564158927,0.59625569476082,0.599129770992366,0.595772975540252,0.596578420759112,0.592865193483384,0.584579045048085,0.586139501524117,0.587701847769593,0.583768545457831,0.579401236576635,0.572954301122645,0.575302819166041,0.578043676557386,0.575638367621782,0.575601858369703,0.574334099225598,0.577308100459851,0.573852955510687,0.571438657182696,0.579424326167319,0.572007386292332,0.578313929547411,0.578649204002074,0.58384089980346,0.585032785899055,0.582331608328919,0.586910171645166,0.588086690599654,0.583718177809751,0.589033751675399,0.585574039422757,0.58970788970789,0.586399559968735,0.580144936436775,0.584147135416667,0.582071941475913,0.578748857055776,0.577233821294296,0.577809376437623,0.57802363814094,0.574793600447782,0.578569570871261,0.581052169619837,0.57331927851956,0.588141809290953,0.582347475998761,0.579022306597057,0.584689777293469,0.579699469652328,0.589376373418201,0.598897637795276,0.589799331103679,0.598972417522985,0.600725952813067,0.602701872889162,0.610093217614915,0.604077392546423,0.611620363841489,0.605852254557083,0.612566438876234,0.61767955801105,0.628641437517016,0.629251700680272,0.627522935779817,0.651204819277108,0.628945342571209,0.634682080924855,0.624203821656051,0.657074340527578,0.669230769230769,0.590909090909091,0.661016949152542,0.640625,0.683673469387755,0.49618320610687],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.721085409252669,0.724428068631764,0.694965287268354,0.660921088068947,0.638651807556401,0.606871109061563,0.586003324353757,0.571704875135104,0.561096546221361,0.55182489800419,0.547722342733189,0.546491178306008,0.528294508686665,0.501044535181844,0.459943415822082,0.430027440219522,0.424856180357606,0.411335283858609,0.404925137903861,0.400865472693389,0.400754382576489,0.400420663578558,0.401714462235494,0.399777435841073,0.40374430523918,0.400870229007634,0.404227024459748,0.403421579240888,0.407134806516616,0.415420954951915,0.413860498475883,0.412298152230407,0.416231454542169,0.420598763423365,0.427045698877355,0.424697180833959,0.421956323442614,0.424361632378218,0.424398141630297,0.425665900774402,0.422691899540149,0.426147044489313,0.428561342817304,0.420575673832681,0.427992613707668,0.421686070452589,0.421350795997926,0.41615910019654,0.414967214100945,0.417668391671081,0.413089828354834,0.411913309400346,0.416281822190249,0.410966248324601,0.414425960577243,0.41029211029211,0.413600440031265,0.419855063563225,0.415852864583333,0.417928058524087,0.421251142944224,0.422766178705704,0.422190623562377,0.42197636185906,0.425206399552218,0.421430429128739,0.418947830380163,0.42668072148044,0.411858190709047,0.417652524001239,0.420977693402943,0.415310222706531,0.420300530347672,0.410623626581799,0.401102362204724,0.410200668896321,0.401027582477015,0.399274047186933,0.397298127110838,0.389906782385085,0.395922607453577,0.388379636158511,0.394147745442917,0.387433561123766,0.38232044198895,0.371358562482984,0.370748299319728,0.372477064220183,0.348795180722892,0.371054657428791,0.365317919075145,0.375796178343949,0.342925659472422,0.330769230769231,0.409090909090909,0.338983050847458,0.359375,0.316326530612245,0.50381679389313],"text":["count: 0.721085409<br />P_ISEV: 1<br />P_AGE: 01","count: 0.724428069<br />P_ISEV: 1<br />P_AGE: 02","count: 0.694965287<br />P_ISEV: 1<br />P_AGE: 03","count: 0.660921088<br />P_ISEV: 1<br />P_AGE: 04","count: 0.638651808<br />P_ISEV: 1<br />P_AGE: 05","count: 0.606871109<br />P_ISEV: 1<br />P_AGE: 06","count: 0.586003324<br />P_ISEV: 1<br />P_AGE: 07","count: 0.571704875<br />P_ISEV: 1<br />P_AGE: 08","count: 0.561096546<br />P_ISEV: 1<br />P_AGE: 09","count: 0.551824898<br />P_ISEV: 1<br />P_AGE: 10","count: 0.547722343<br />P_ISEV: 1<br />P_AGE: 11","count: 0.546491178<br />P_ISEV: 1<br />P_AGE: 12","count: 0.528294509<br />P_ISEV: 1<br />P_AGE: 13","count: 0.501044535<br />P_ISEV: 1<br />P_AGE: 14","count: 0.459943416<br />P_ISEV: 1<br />P_AGE: 15","count: 0.430027440<br />P_ISEV: 1<br />P_AGE: 16","count: 0.424856180<br />P_ISEV: 1<br />P_AGE: 17","count: 0.411335284<br />P_ISEV: 1<br />P_AGE: 18","count: 0.404925138<br />P_ISEV: 1<br />P_AGE: 19","count: 0.400865473<br />P_ISEV: 1<br />P_AGE: 20","count: 0.400754383<br />P_ISEV: 1<br />P_AGE: 21","count: 0.400420664<br />P_ISEV: 1<br />P_AGE: 22","count: 0.401714462<br />P_ISEV: 1<br />P_AGE: 23","count: 0.399777436<br />P_ISEV: 1<br />P_AGE: 24","count: 0.403744305<br />P_ISEV: 1<br />P_AGE: 25","count: 0.400870229<br />P_ISEV: 1<br />P_AGE: 26","count: 0.404227024<br />P_ISEV: 1<br />P_AGE: 27","count: 0.403421579<br />P_ISEV: 1<br />P_AGE: 28","count: 0.407134807<br />P_ISEV: 1<br />P_AGE: 29","count: 0.415420955<br />P_ISEV: 1<br />P_AGE: 30","count: 0.413860498<br />P_ISEV: 1<br />P_AGE: 31","count: 0.412298152<br />P_ISEV: 1<br />P_AGE: 32","count: 0.416231455<br />P_ISEV: 1<br />P_AGE: 33","count: 0.420598763<br />P_ISEV: 1<br />P_AGE: 34","count: 0.427045699<br />P_ISEV: 1<br />P_AGE: 35","count: 0.424697181<br />P_ISEV: 1<br />P_AGE: 36","count: 0.421956323<br />P_ISEV: 1<br />P_AGE: 37","count: 0.424361632<br />P_ISEV: 1<br />P_AGE: 38","count: 0.424398142<br />P_ISEV: 1<br />P_AGE: 39","count: 0.425665901<br />P_ISEV: 1<br />P_AGE: 40","count: 0.422691900<br />P_ISEV: 1<br />P_AGE: 41","count: 0.426147044<br />P_ISEV: 1<br />P_AGE: 42","count: 0.428561343<br />P_ISEV: 1<br />P_AGE: 43","count: 0.420575674<br />P_ISEV: 1<br />P_AGE: 44","count: 0.427992614<br />P_ISEV: 1<br />P_AGE: 45","count: 0.421686070<br />P_ISEV: 1<br />P_AGE: 46","count: 0.421350796<br />P_ISEV: 1<br />P_AGE: 47","count: 0.416159100<br />P_ISEV: 1<br />P_AGE: 48","count: 0.414967214<br />P_ISEV: 1<br />P_AGE: 49","count: 0.417668392<br />P_ISEV: 1<br />P_AGE: 50","count: 0.413089828<br />P_ISEV: 1<br />P_AGE: 51","count: 0.411913309<br />P_ISEV: 1<br />P_AGE: 52","count: 0.416281822<br />P_ISEV: 1<br />P_AGE: 53","count: 0.410966248<br />P_ISEV: 1<br />P_AGE: 54","count: 0.414425961<br />P_ISEV: 1<br />P_AGE: 55","count: 0.410292110<br />P_ISEV: 1<br />P_AGE: 56","count: 0.413600440<br />P_ISEV: 1<br />P_AGE: 57","count: 0.419855064<br />P_ISEV: 1<br />P_AGE: 58","count: 0.415852865<br />P_ISEV: 1<br />P_AGE: 59","count: 0.417928059<br />P_ISEV: 1<br />P_AGE: 60","count: 0.421251143<br />P_ISEV: 1<br />P_AGE: 61","count: 0.422766179<br />P_ISEV: 1<br />P_AGE: 62","count: 0.422190624<br />P_ISEV: 1<br />P_AGE: 63","count: 0.421976362<br />P_ISEV: 1<br />P_AGE: 64","count: 0.425206400<br />P_ISEV: 1<br />P_AGE: 65","count: 0.421430429<br />P_ISEV: 1<br />P_AGE: 66","count: 0.418947830<br />P_ISEV: 1<br />P_AGE: 67","count: 0.426680721<br />P_ISEV: 1<br />P_AGE: 68","count: 0.411858191<br />P_ISEV: 1<br />P_AGE: 69","count: 0.417652524<br />P_ISEV: 1<br />P_AGE: 70","count: 0.420977693<br />P_ISEV: 1<br />P_AGE: 71","count: 0.415310223<br />P_ISEV: 1<br />P_AGE: 72","count: 0.420300530<br />P_ISEV: 1<br />P_AGE: 73","count: 0.410623627<br />P_ISEV: 1<br />P_AGE: 74","count: 0.401102362<br />P_ISEV: 1<br />P_AGE: 75","count: 0.410200669<br />P_ISEV: 1<br />P_AGE: 76","count: 0.401027582<br />P_ISEV: 1<br />P_AGE: 77","count: 0.399274047<br />P_ISEV: 1<br />P_AGE: 78","count: 0.397298127<br />P_ISEV: 1<br />P_AGE: 79","count: 0.389906782<br />P_ISEV: 1<br />P_AGE: 80","count: 0.395922607<br />P_ISEV: 1<br />P_AGE: 81","count: 0.388379636<br />P_ISEV: 1<br />P_AGE: 82","count: 0.394147745<br />P_ISEV: 1<br />P_AGE: 83","count: 0.387433561<br />P_ISEV: 1<br />P_AGE: 84","count: 0.382320442<br />P_ISEV: 1<br />P_AGE: 85","count: 0.371358562<br />P_ISEV: 1<br />P_AGE: 86","count: 0.370748299<br />P_ISEV: 1<br />P_AGE: 87","count: 0.372477064<br />P_ISEV: 1<br />P_AGE: 88","count: 0.348795181<br />P_ISEV: 1<br />P_AGE: 89","count: 0.371054657<br />P_ISEV: 1<br />P_AGE: 90","count: 0.365317919<br />P_ISEV: 1<br />P_AGE: 91","count: 0.375796178<br />P_ISEV: 1<br />P_AGE: 92","count: 0.342925659<br />P_ISEV: 1<br />P_AGE: 93","count: 0.330769231<br />P_ISEV: 1<br />P_AGE: 94","count: 0.409090909<br />P_ISEV: 1<br />P_AGE: 95","count: 0.338983051<br />P_ISEV: 1<br />P_AGE: 96","count: 0.359375000<br />P_ISEV: 1<br />P_AGE: 97","count: 0.316326531<br />P_ISEV: 1<br />P_AGE: 98","count: 0.503816794<br />P_ISEV: 1<br />P_AGE: 99"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(50,205,50,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.900000000000002,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006],"base":[0.00246372844237613,0.00137483501979762,0.00120264582080577,0.00166980877996229,0.00119597716770862,0.00190223656905695,0.00252192353986359,0.00210478411741282,0.00262168015502109,0.00248097915977506,0.0030254595273433,0.00289328870482782,0.00296072845092453,0.00337099990504226,0.00519285177094152,0.00688805510444084,0.00633324695516973,0.00685225247548342,0.00742710795902285,0.00737020541815387,0.00722571263022756,0.00717316506790191,0.00638418369973742,0.0064433697862285,0.00629271070615034,0.00621374045801527,0.00579434813583472,0.00544565823573795,0.0057549779705591,0.00526404589168213,0.00521785906401291,0.00523325626825815,0.00509604785225075,0.00500777380048451,0.00523431028709399,0.00444849394361668,0.00491853123714475,0.00559956054081832,0.00492749542446853,0.00513998808612033,0.00521754510081358,0.0054828378472464,0.00524207070617929,0.00506047446434339,0.00536044030907689,0.00533448133867405,0.00560751253048605,0.0061297164762887,0.00661733742405101,0.00586773155128153,0.0063747765597743,0.00593892656118424,0.00659070339514052,0.00672596563908858,0.00651065029605516,0.00704340704340704,0.00717945748776887,0.00703187373334152,0.00716145833333333,0.00778747935138051,0.00731484303565986,0.0070394368450524,0.00945171678307055,0.00848662578867857,0.00802276225570222,0.00738621586475943,0.00905151132810357,0.00919419067697353,0.0106968215158924,0.0108392691235677,0.0107125906841142,0.0111012735816931,0.0122274602239246,0.012351291960294,0.0125196850393701,0.01438127090301,0.0142419325761673,0.0148056165822906,0.0158632688568212,0.016500589306761,0.0201272562004934,0.0180510506275561,0.0199872081867605,0.0210706150341686,0.0234254143646409,0.0250476449768582,0.0292517006802721,0.0247706422018349,0.0240963855421687,0.0323325635103926,0.0393063583815029,0.0334394904458599,0.0431654676258993,0.0538461538461538,0.038961038961039,0.0338983050847458,0.015625,0,0.00763358778625954],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.276450862304955,0.274197096348438,0.30383206691084,0.337409103151091,0.36015221527589,0.39122665436938,0.411474752106379,0.426190340747483,0.436281773623618,0.445694122836035,0.449252197739468,0.450615532989164,0.46874476286241,0.495584464913114,0.534863732406976,0.563084504676037,0.568810572687225,0.581812463665907,0.587647754137116,0.591764321888457,0.592019904793283,0.59240617135354,0.591901354064769,0.593779194372699,0.58996298405467,0.592916030534351,0.589978627404417,0.591132762523374,0.587110215512825,0.579314999156403,0.580921642460104,0.582468591501335,0.57867249760558,0.574393462776151,0.567719990835551,0.570854325222425,0.573125145320241,0.570038807080963,0.570674362945234,0.569194111139477,0.572090555359038,0.568370117663441,0.566196586476516,0.574363851702975,0.566646945983255,0.572979448208737,0.573041691471588,0.577711183327171,0.578415448475004,0.576463876777637,0.580535395085392,0.58214776403847,0.577127474414611,0.582307786036311,0.579063389126701,0.582664482664483,0.579220102480966,0.573113062703433,0.576985677083333,0.574284462124532,0.571434014020116,0.570194384449244,0.568357659654552,0.569537012352262,0.56677083819208,0.571183355006502,0.572000658291733,0.564125087842586,0.577444987775061,0.571508206875194,0.568309715912943,0.573588503711775,0.567472009428403,0.577025081457907,0.586377952755906,0.575418060200669,0.584730484946818,0.585920336230777,0.586838604032341,0.593592628308154,0.583950136345929,0.593569313213933,0.585865046370323,0.591495823842065,0.594254143646409,0.603593792540158,0.6,0.602752293577982,0.62710843373494,0.596612779060816,0.595375722543353,0.590764331210191,0.613908872901679,0.615384615384615,0.551948051948052,0.627118644067797,0.625,0.683673469387755,0.488549618320611],"text":["count: 0.276450862<br />P_ISEV: 2<br />P_AGE: 01","count: 0.274197096<br />P_ISEV: 2<br />P_AGE: 02","count: 0.303832067<br />P_ISEV: 2<br />P_AGE: 03","count: 0.337409103<br />P_ISEV: 2<br />P_AGE: 04","count: 0.360152215<br />P_ISEV: 2<br />P_AGE: 05","count: 0.391226654<br />P_ISEV: 2<br />P_AGE: 06","count: 0.411474752<br />P_ISEV: 2<br />P_AGE: 07","count: 0.426190341<br />P_ISEV: 2<br />P_AGE: 08","count: 0.436281774<br />P_ISEV: 2<br />P_AGE: 09","count: 0.445694123<br />P_ISEV: 2<br />P_AGE: 10","count: 0.449252198<br />P_ISEV: 2<br />P_AGE: 11","count: 0.450615533<br />P_ISEV: 2<br />P_AGE: 12","count: 0.468744763<br />P_ISEV: 2<br />P_AGE: 13","count: 0.495584465<br />P_ISEV: 2<br />P_AGE: 14","count: 0.534863732<br />P_ISEV: 2<br />P_AGE: 15","count: 0.563084505<br />P_ISEV: 2<br />P_AGE: 16","count: 0.568810573<br />P_ISEV: 2<br />P_AGE: 17","count: 0.581812464<br />P_ISEV: 2<br />P_AGE: 18","count: 0.587647754<br />P_ISEV: 2<br />P_AGE: 19","count: 0.591764322<br />P_ISEV: 2<br />P_AGE: 20","count: 0.592019905<br />P_ISEV: 2<br />P_AGE: 21","count: 0.592406171<br />P_ISEV: 2<br />P_AGE: 22","count: 0.591901354<br />P_ISEV: 2<br />P_AGE: 23","count: 0.593779194<br />P_ISEV: 2<br />P_AGE: 24","count: 0.589962984<br />P_ISEV: 2<br />P_AGE: 25","count: 0.592916031<br />P_ISEV: 2<br />P_AGE: 26","count: 0.589978627<br />P_ISEV: 2<br />P_AGE: 27","count: 0.591132763<br />P_ISEV: 2<br />P_AGE: 28","count: 0.587110216<br />P_ISEV: 2<br />P_AGE: 29","count: 0.579314999<br />P_ISEV: 2<br />P_AGE: 30","count: 0.580921642<br />P_ISEV: 2<br />P_AGE: 31","count: 0.582468592<br />P_ISEV: 2<br />P_AGE: 32","count: 0.578672498<br />P_ISEV: 2<br />P_AGE: 33","count: 0.574393463<br />P_ISEV: 2<br />P_AGE: 34","count: 0.567719991<br />P_ISEV: 2<br />P_AGE: 35","count: 0.570854325<br />P_ISEV: 2<br />P_AGE: 36","count: 0.573125145<br />P_ISEV: 2<br />P_AGE: 37","count: 0.570038807<br />P_ISEV: 2<br />P_AGE: 38","count: 0.570674363<br />P_ISEV: 2<br />P_AGE: 39","count: 0.569194111<br />P_ISEV: 2<br />P_AGE: 40","count: 0.572090555<br />P_ISEV: 2<br />P_AGE: 41","count: 0.568370118<br />P_ISEV: 2<br />P_AGE: 42","count: 0.566196586<br />P_ISEV: 2<br />P_AGE: 43","count: 0.574363852<br />P_ISEV: 2<br />P_AGE: 44","count: 0.566646946<br />P_ISEV: 2<br />P_AGE: 45","count: 0.572979448<br />P_ISEV: 2<br />P_AGE: 46","count: 0.573041691<br />P_ISEV: 2<br />P_AGE: 47","count: 0.577711183<br />P_ISEV: 2<br />P_AGE: 48","count: 0.578415448<br />P_ISEV: 2<br />P_AGE: 49","count: 0.576463877<br />P_ISEV: 2<br />P_AGE: 50","count: 0.580535395<br />P_ISEV: 2<br />P_AGE: 51","count: 0.582147764<br />P_ISEV: 2<br />P_AGE: 52","count: 0.577127474<br />P_ISEV: 2<br />P_AGE: 53","count: 0.582307786<br />P_ISEV: 2<br />P_AGE: 54","count: 0.579063389<br />P_ISEV: 2<br />P_AGE: 55","count: 0.582664483<br />P_ISEV: 2<br />P_AGE: 56","count: 0.579220102<br />P_ISEV: 2<br />P_AGE: 57","count: 0.573113063<br />P_ISEV: 2<br />P_AGE: 58","count: 0.576985677<br />P_ISEV: 2<br />P_AGE: 59","count: 0.574284462<br />P_ISEV: 2<br />P_AGE: 60","count: 0.571434014<br />P_ISEV: 2<br />P_AGE: 61","count: 0.570194384<br />P_ISEV: 2<br />P_AGE: 62","count: 0.568357660<br />P_ISEV: 2<br />P_AGE: 63","count: 0.569537012<br />P_ISEV: 2<br />P_AGE: 64","count: 0.566770838<br />P_ISEV: 2<br />P_AGE: 65","count: 0.571183355<br />P_ISEV: 2<br />P_AGE: 66","count: 0.572000658<br />P_ISEV: 2<br />P_AGE: 67","count: 0.564125088<br />P_ISEV: 2<br />P_AGE: 68","count: 0.577444988<br />P_ISEV: 2<br />P_AGE: 69","count: 0.571508207<br />P_ISEV: 2<br />P_AGE: 70","count: 0.568309716<br />P_ISEV: 2<br />P_AGE: 71","count: 0.573588504<br />P_ISEV: 2<br />P_AGE: 72","count: 0.567472009<br />P_ISEV: 2<br />P_AGE: 73","count: 0.577025081<br />P_ISEV: 2<br />P_AGE: 74","count: 0.586377953<br />P_ISEV: 2<br />P_AGE: 75","count: 0.575418060<br />P_ISEV: 2<br />P_AGE: 76","count: 0.584730485<br />P_ISEV: 2<br />P_AGE: 77","count: 0.585920336<br />P_ISEV: 2<br />P_AGE: 78","count: 0.586838604<br />P_ISEV: 2<br />P_AGE: 79","count: 0.593592628<br />P_ISEV: 2<br />P_AGE: 80","count: 0.583950136<br />P_ISEV: 2<br />P_AGE: 81","count: 0.593569313<br />P_ISEV: 2<br />P_AGE: 82","count: 0.585865046<br />P_ISEV: 2<br />P_AGE: 83","count: 0.591495824<br />P_ISEV: 2<br />P_AGE: 84","count: 0.594254144<br />P_ISEV: 2<br />P_AGE: 85","count: 0.603593793<br />P_ISEV: 2<br />P_AGE: 86","count: 0.600000000<br />P_ISEV: 2<br />P_AGE: 87","count: 0.602752294<br />P_ISEV: 2<br />P_AGE: 88","count: 0.627108434<br />P_ISEV: 2<br />P_AGE: 89","count: 0.596612779<br />P_ISEV: 2<br />P_AGE: 90","count: 0.595375723<br />P_ISEV: 2<br />P_AGE: 91","count: 0.590764331<br />P_ISEV: 2<br />P_AGE: 92","count: 0.613908873<br />P_ISEV: 2<br />P_AGE: 93","count: 0.615384615<br />P_ISEV: 2<br />P_AGE: 94","count: 0.551948052<br />P_ISEV: 2<br />P_AGE: 95","count: 0.627118644<br />P_ISEV: 2<br />P_AGE: 96","count: 0.625000000<br />P_ISEV: 2<br />P_AGE: 97","count: 0.683673469<br />P_ISEV: 2<br />P_AGE: 98","count: 0.488549618<br />P_ISEV: 2<br />P_AGE: 99"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(174,238,238,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.900000000000002,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,99],"y":[0.00246372844237613,0.00137483501979762,0.00120264582080577,0.00166980877996229,0.00119597716770862,0.00190223656905695,0.00252192353986359,0.00210478411741282,0.00262168015502109,0.00248097915977506,0.0030254595273433,0.00289328870482782,0.00296072845092453,0.00337099990504226,0.00519285177094152,0.00688805510444084,0.00633324695516973,0.00685225247548342,0.00742710795902285,0.00737020541815387,0.00722571263022756,0.00717316506790191,0.00638418369973742,0.0064433697862285,0.00629271070615034,0.00621374045801527,0.00579434813583472,0.00544565823573795,0.0057549779705591,0.00526404589168213,0.00521785906401291,0.00523325626825815,0.00509604785225075,0.00500777380048451,0.00523431028709399,0.00444849394361668,0.00491853123714475,0.00559956054081832,0.00492749542446853,0.00513998808612033,0.00521754510081358,0.0054828378472464,0.00524207070617929,0.00506047446434339,0.00536044030907689,0.00533448133867405,0.00560751253048605,0.0061297164762887,0.00661733742405101,0.00586773155128153,0.0063747765597743,0.00593892656118424,0.00659070339514052,0.00672596563908858,0.00651065029605516,0.00704340704340704,0.00717945748776887,0.00703187373334152,0.00716145833333333,0.00778747935138051,0.00731484303565986,0.0070394368450524,0.00945171678307055,0.00848662578867857,0.00802276225570222,0.00738621586475943,0.00905151132810357,0.00919419067697353,0.0106968215158924,0.0108392691235677,0.0107125906841142,0.0111012735816931,0.0122274602239246,0.012351291960294,0.0125196850393701,0.01438127090301,0.0142419325761673,0.0148056165822906,0.0158632688568212,0.016500589306761,0.0201272562004934,0.0180510506275561,0.0199872081867605,0.0210706150341686,0.0234254143646409,0.0250476449768582,0.0292517006802721,0.0247706422018349,0.0240963855421687,0.0323325635103926,0.0393063583815029,0.0334394904458599,0.0431654676258993,0.0538461538461538,0.038961038961039,0.0338983050847458,0.015625,0.00763358778625954],"text":["count: 0.002463728<br />P_ISEV: 3<br />P_AGE: 01","count: 0.001374835<br />P_ISEV: 3<br />P_AGE: 02","count: 0.001202646<br />P_ISEV: 3<br />P_AGE: 03","count: 0.001669809<br />P_ISEV: 3<br />P_AGE: 04","count: 0.001195977<br />P_ISEV: 3<br />P_AGE: 05","count: 0.001902237<br />P_ISEV: 3<br />P_AGE: 06","count: 0.002521924<br />P_ISEV: 3<br />P_AGE: 07","count: 0.002104784<br />P_ISEV: 3<br />P_AGE: 08","count: 0.002621680<br />P_ISEV: 3<br />P_AGE: 09","count: 0.002480979<br />P_ISEV: 3<br />P_AGE: 10","count: 0.003025460<br />P_ISEV: 3<br />P_AGE: 11","count: 0.002893289<br />P_ISEV: 3<br />P_AGE: 12","count: 0.002960728<br />P_ISEV: 3<br />P_AGE: 13","count: 0.003371000<br />P_ISEV: 3<br />P_AGE: 14","count: 0.005192852<br />P_ISEV: 3<br />P_AGE: 15","count: 0.006888055<br />P_ISEV: 3<br />P_AGE: 16","count: 0.006333247<br />P_ISEV: 3<br />P_AGE: 17","count: 0.006852252<br />P_ISEV: 3<br />P_AGE: 18","count: 0.007427108<br />P_ISEV: 3<br />P_AGE: 19","count: 0.007370205<br />P_ISEV: 3<br />P_AGE: 20","count: 0.007225713<br />P_ISEV: 3<br />P_AGE: 21","count: 0.007173165<br />P_ISEV: 3<br />P_AGE: 22","count: 0.006384184<br />P_ISEV: 3<br />P_AGE: 23","count: 0.006443370<br />P_ISEV: 3<br />P_AGE: 24","count: 0.006292711<br />P_ISEV: 3<br />P_AGE: 25","count: 0.006213740<br />P_ISEV: 3<br />P_AGE: 26","count: 0.005794348<br />P_ISEV: 3<br />P_AGE: 27","count: 0.005445658<br />P_ISEV: 3<br />P_AGE: 28","count: 0.005754978<br />P_ISEV: 3<br />P_AGE: 29","count: 0.005264046<br />P_ISEV: 3<br />P_AGE: 30","count: 0.005217859<br />P_ISEV: 3<br />P_AGE: 31","count: 0.005233256<br />P_ISEV: 3<br />P_AGE: 32","count: 0.005096048<br />P_ISEV: 3<br />P_AGE: 33","count: 0.005007774<br />P_ISEV: 3<br />P_AGE: 34","count: 0.005234310<br />P_ISEV: 3<br />P_AGE: 35","count: 0.004448494<br />P_ISEV: 3<br />P_AGE: 36","count: 0.004918531<br />P_ISEV: 3<br />P_AGE: 37","count: 0.005599561<br />P_ISEV: 3<br />P_AGE: 38","count: 0.004927495<br />P_ISEV: 3<br />P_AGE: 39","count: 0.005139988<br />P_ISEV: 3<br />P_AGE: 40","count: 0.005217545<br />P_ISEV: 3<br />P_AGE: 41","count: 0.005482838<br />P_ISEV: 3<br />P_AGE: 42","count: 0.005242071<br />P_ISEV: 3<br />P_AGE: 43","count: 0.005060474<br />P_ISEV: 3<br />P_AGE: 44","count: 0.005360440<br />P_ISEV: 3<br />P_AGE: 45","count: 0.005334481<br />P_ISEV: 3<br />P_AGE: 46","count: 0.005607513<br />P_ISEV: 3<br />P_AGE: 47","count: 0.006129716<br />P_ISEV: 3<br />P_AGE: 48","count: 0.006617337<br />P_ISEV: 3<br />P_AGE: 49","count: 0.005867732<br />P_ISEV: 3<br />P_AGE: 50","count: 0.006374777<br />P_ISEV: 3<br />P_AGE: 51","count: 0.005938927<br />P_ISEV: 3<br />P_AGE: 52","count: 0.006590703<br />P_ISEV: 3<br />P_AGE: 53","count: 0.006725966<br />P_ISEV: 3<br />P_AGE: 54","count: 0.006510650<br />P_ISEV: 3<br />P_AGE: 55","count: 0.007043407<br />P_ISEV: 3<br />P_AGE: 56","count: 0.007179457<br />P_ISEV: 3<br />P_AGE: 57","count: 0.007031874<br />P_ISEV: 3<br />P_AGE: 58","count: 0.007161458<br />P_ISEV: 3<br />P_AGE: 59","count: 0.007787479<br />P_ISEV: 3<br />P_AGE: 60","count: 0.007314843<br />P_ISEV: 3<br />P_AGE: 61","count: 0.007039437<br />P_ISEV: 3<br />P_AGE: 62","count: 0.009451717<br />P_ISEV: 3<br />P_AGE: 63","count: 0.008486626<br />P_ISEV: 3<br />P_AGE: 64","count: 0.008022762<br />P_ISEV: 3<br />P_AGE: 65","count: 0.007386216<br />P_ISEV: 3<br />P_AGE: 66","count: 0.009051511<br />P_ISEV: 3<br />P_AGE: 67","count: 0.009194191<br />P_ISEV: 3<br />P_AGE: 68","count: 0.010696822<br />P_ISEV: 3<br />P_AGE: 69","count: 0.010839269<br />P_ISEV: 3<br />P_AGE: 70","count: 0.010712591<br />P_ISEV: 3<br />P_AGE: 71","count: 0.011101274<br />P_ISEV: 3<br />P_AGE: 72","count: 0.012227460<br />P_ISEV: 3<br />P_AGE: 73","count: 0.012351292<br />P_ISEV: 3<br />P_AGE: 74","count: 0.012519685<br />P_ISEV: 3<br />P_AGE: 75","count: 0.014381271<br />P_ISEV: 3<br />P_AGE: 76","count: 0.014241933<br />P_ISEV: 3<br />P_AGE: 77","count: 0.014805617<br />P_ISEV: 3<br />P_AGE: 78","count: 0.015863269<br />P_ISEV: 3<br />P_AGE: 79","count: 0.016500589<br />P_ISEV: 3<br />P_AGE: 80","count: 0.020127256<br />P_ISEV: 3<br />P_AGE: 81","count: 0.018051051<br />P_ISEV: 3<br />P_AGE: 82","count: 0.019987208<br />P_ISEV: 3<br />P_AGE: 83","count: 0.021070615<br />P_ISEV: 3<br />P_AGE: 84","count: 0.023425414<br />P_ISEV: 3<br />P_AGE: 85","count: 0.025047645<br />P_ISEV: 3<br />P_AGE: 86","count: 0.029251701<br />P_ISEV: 3<br />P_AGE: 87","count: 0.024770642<br />P_ISEV: 3<br />P_AGE: 88","count: 0.024096386<br />P_ISEV: 3<br />P_AGE: 89","count: 0.032332564<br />P_ISEV: 3<br />P_AGE: 90","count: 0.039306358<br />P_ISEV: 3<br />P_AGE: 91","count: 0.033439490<br />P_ISEV: 3<br />P_AGE: 92","count: 0.043165468<br />P_ISEV: 3<br />P_AGE: 93","count: 0.053846154<br />P_ISEV: 3<br />P_AGE: 94","count: 0.038961039<br />P_ISEV: 3<br />P_AGE: 95","count: 0.033898305<br />P_ISEV: 3<br />P_AGE: 96","count: 0.015625000<br />P_ISEV: 3<br />P_AGE: 97","count: 0.007633588<br />P_ISEV: 3<br />P_AGE: 99"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.7108066971081,"r":7.30593607305936,"b":30.441400304414,"l":48.9497716894977},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Medical treatment by age (percentage)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,99.6],"tickmode":"array","ticktext":["01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"categoryorder":"array","categoryarray":["01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"P_AGE","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.05,1.05],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.963910761154856},"annotations":[{"text":"P_ISEV","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"4014279e1866":{"fill":{},"x":{},"type":"bar"}},"cur_data":"4014279e1866","visdat":{"4014279e1866":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
The charts below firstly show that most of the people accounted for in this data were in fact the drivers themselves, since the highest number of accidents are shown in the driver seat. However, examining the percentages shows that the highest percentage of fatalities is where either the occupant’s position is unknown, or where the occupant was sitting on someone’s lap. The highest percentage of injuries (class 2- blue) is when the occupant was in an outside compartment, such as the back of a pick-up truck.</p>
<pre class="r"><code>#position and severity

ggplotly(ggplot(acc_clean, aes(P_PSN)) +
  geom_bar(aes(fill = P_ISEV), stat = &quot;count&quot;) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle(&quot;Medical treatment by person position (absolute numbers)&quot;) +
  scale_fill_manual(values = c(&quot;limegreen&quot;, &quot;paleturquoise2&quot;,&quot;red&quot;)) +
  theme_minimal())</code></pre>
<div id="htmlwidget-13" style="width:720px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-13">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999],"base":[1277691,30233,367098,69304,26840,86341,679,10532,881,8780,79,306],"x":[1,2,3,4,5,6,7,8,9,10,11,12],"y":[935091,16010,238147,79747,34025,97529,813,11048,923,3158,67,17],"text":["count:  935091<br />P_ISEV: 1<br />P_PSN: 11","count:   16010<br />P_ISEV: 1<br />P_PSN: 12","count:  238147<br />P_ISEV: 1<br />P_PSN: 13","count:   79747<br />P_ISEV: 1<br />P_PSN: 21","count:   34025<br />P_ISEV: 1<br />P_PSN: 22","count:   97529<br />P_ISEV: 1<br />P_PSN: 23","count:     813<br />P_ISEV: 1<br />P_PSN: 31","count:   11048<br />P_ISEV: 1<br />P_PSN: 32","count:     923<br />P_ISEV: 1<br />P_PSN: 33","count:    3158<br />P_ISEV: 1<br />P_PSN: 96","count:      67<br />P_ISEV: 1<br />P_PSN: 97","count:      17<br />P_ISEV: 1<br />P_PSN: 98"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(50,205,50,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999],"base":[14836,327,3650,745,294,777,8,141,8,331,3,5],"x":[1,2,3,4,5,6,7,8,9,10,11,12],"y":[1262855,29906,363448,68559,26546,85564,671,10391,873,8449,76,301],"text":["count: 1262855<br />P_ISEV: 2<br />P_PSN: 11","count:   29906<br />P_ISEV: 2<br />P_PSN: 12","count:  363448<br />P_ISEV: 2<br />P_PSN: 13","count:   68559<br />P_ISEV: 2<br />P_PSN: 21","count:   26546<br />P_ISEV: 2<br />P_PSN: 22","count:   85564<br />P_ISEV: 2<br />P_PSN: 23","count:     671<br />P_ISEV: 2<br />P_PSN: 31","count:   10391<br />P_ISEV: 2<br />P_PSN: 32","count:     873<br />P_ISEV: 2<br />P_PSN: 33","count:    8449<br />P_ISEV: 2<br />P_PSN: 96","count:      76<br />P_ISEV: 2<br />P_PSN: 97","count:     301<br />P_ISEV: 2<br />P_PSN: 98"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(174,238,238,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999],"base":[0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7,8,9,10,11,12],"y":[14836,327,3650,745,294,777,8,141,8,331,3,5],"text":["count:   14836<br />P_ISEV: 3<br />P_PSN: 11","count:     327<br />P_ISEV: 3<br />P_PSN: 12","count:    3650<br />P_ISEV: 3<br />P_PSN: 13","count:     745<br />P_ISEV: 3<br />P_PSN: 21","count:     294<br />P_ISEV: 3<br />P_PSN: 22","count:     777<br />P_ISEV: 3<br />P_PSN: 23","count:       8<br />P_ISEV: 3<br />P_PSN: 31","count:     141<br />P_ISEV: 3<br />P_PSN: 32","count:       8<br />P_ISEV: 3<br />P_PSN: 33","count:     331<br />P_ISEV: 3<br />P_PSN: 96","count:       3<br />P_ISEV: 3<br />P_PSN: 97","count:       5<br />P_ISEV: 3<br />P_PSN: 98"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.7108066971081,"r":7.30593607305936,"b":42.130898021309,"l":78.1735159817352},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Medical treatment by person position (absolute numbers)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,12.6],"tickmode":"array","ticktext":["11","12","13","21","22","23","31","32","33","96","97","98"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12],"categoryorder":"array","categoryarray":["11","12","13","21","22","23","31","32","33","96","97","98"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"P_PSN","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-110639.1,2323421.1],"tickmode":"array","ticktext":["0","500,000","1,000,000","1,500,000","2,000,000"],"tickvals":[0,500000,1000000,1500000,2000000],"categoryorder":"array","categoryarray":["0","500,000","1,000,000","1,500,000","2,000,000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.963910761154856},"annotations":[{"text":"P_ISEV","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"401467b1626f":{"fill":{},"x":{},"type":"bar"}},"cur_data":"401467b1626f","visdat":{"401467b1626f":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>ggplotly(ggplot(acc_clean, aes(P_PSN)) +
  geom_bar(aes(fill = P_ISEV), stat = &quot;count&quot;, position = &quot;fill&quot;) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle(&quot;Medical treatment by person position (percentage)&quot;) +
  scale_fill_manual(values = c(&quot;limegreen&quot;, &quot;paleturquoise2&quot;,&quot;red&quot;)) +
  theme_minimal())</code></pre>
<p><div id="htmlwidget-14" style="width:720px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-14">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999],"base":[0.577413861826425,0.653785437795991,0.606527934968484,0.464968366532261,0.440975930337632,0.469576331103497,0.455093833780161,0.488044485634847,0.488359201773836,0.735466577316133,0.541095890410959,0.947368421052632],"x":[1,2,3,4,5,6,7,8,9,10,11,12],"y":[0.422586138173575,0.346214562204009,0.393472065031516,0.535031633467739,0.559024069662368,0.530423668896503,0.544906166219839,0.511955514365153,0.511640798226164,0.264533422683867,0.458904109589041,0.0526315789473685],"text":["count: 0.422586138<br />P_ISEV: 1<br />P_PSN: 11","count: 0.346214562<br />P_ISEV: 1<br />P_PSN: 12","count: 0.393472065<br />P_ISEV: 1<br />P_PSN: 13","count: 0.535031633<br />P_ISEV: 1<br />P_PSN: 21","count: 0.559024070<br />P_ISEV: 1<br />P_PSN: 22","count: 0.530423669<br />P_ISEV: 1<br />P_PSN: 23","count: 0.544906166<br />P_ISEV: 1<br />P_PSN: 31","count: 0.511955514<br />P_ISEV: 1<br />P_PSN: 32","count: 0.511640798<br />P_ISEV: 1<br />P_PSN: 33","count: 0.264533423<br />P_ISEV: 1<br />P_PSN: 96","count: 0.458904110<br />P_ISEV: 1<br />P_PSN: 97","count: 0.052631579<br />P_ISEV: 1<br />P_PSN: 98"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(50,205,50,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999],"base":[0.00670468216028511,0.00707134052721493,0.00603061570107973,0.00499828917618802,0.00483036227717079,0.0042258117147985,0.00536193029490617,0.00653382761816497,0.00443458980044346,0.0277265873680684,0.0205479452054795,0.0154798761609907],"x":[1,2,3,4,5,6,7,8,9,10,11,12],"y":[0.57070917966614,0.646714097268776,0.600497319267404,0.459970077356073,0.436145568060462,0.465350519388699,0.449731903485255,0.481510658016682,0.483924611973392,0.707739989948065,0.52054794520548,0.931888544891641],"text":["count: 0.570709180<br />P_ISEV: 2<br />P_PSN: 11","count: 0.646714097<br />P_ISEV: 2<br />P_PSN: 12","count: 0.600497319<br />P_ISEV: 2<br />P_PSN: 13","count: 0.459970077<br />P_ISEV: 2<br />P_PSN: 21","count: 0.436145568<br />P_ISEV: 2<br />P_PSN: 22","count: 0.465350519<br />P_ISEV: 2<br />P_PSN: 23","count: 0.449731903<br />P_ISEV: 2<br />P_PSN: 31","count: 0.481510658<br />P_ISEV: 2<br />P_PSN: 32","count: 0.483924612<br />P_ISEV: 2<br />P_PSN: 33","count: 0.707739990<br />P_ISEV: 2<br />P_PSN: 96","count: 0.520547945<br />P_ISEV: 2<br />P_PSN: 97","count: 0.931888545<br />P_ISEV: 2<br />P_PSN: 98"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(174,238,238,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999],"base":[0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7,8,9,10,11,12],"y":[0.00670468216028511,0.00707134052721493,0.00603061570107973,0.00499828917618802,0.00483036227717079,0.0042258117147985,0.00536193029490617,0.00653382761816497,0.00443458980044346,0.0277265873680684,0.0205479452054795,0.0154798761609907],"text":["count: 0.006704682<br />P_ISEV: 3<br />P_PSN: 11","count: 0.007071341<br />P_ISEV: 3<br />P_PSN: 12","count: 0.006030616<br />P_ISEV: 3<br />P_PSN: 13","count: 0.004998289<br />P_ISEV: 3<br />P_PSN: 21","count: 0.004830362<br />P_ISEV: 3<br />P_PSN: 22","count: 0.004225812<br />P_ISEV: 3<br />P_PSN: 23","count: 0.005361930<br />P_ISEV: 3<br />P_PSN: 31","count: 0.006533828<br />P_ISEV: 3<br />P_PSN: 32","count: 0.004434590<br />P_ISEV: 3<br />P_PSN: 33","count: 0.027726587<br />P_ISEV: 3<br />P_PSN: 96","count: 0.020547945<br />P_ISEV: 3<br />P_PSN: 97","count: 0.015479876<br />P_ISEV: 3<br />P_PSN: 98"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.7108066971081,"r":7.30593607305936,"b":42.130898021309,"l":48.9497716894977},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Medical treatment by person position (percentage)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,12.6],"tickmode":"array","ticktext":["11","12","13","21","22","23","31","32","33","96","97","98"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12],"categoryorder":"array","categoryarray":["11","12","13","21","22","23","31","32","33","96","97","98"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"P_PSN","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.05,1.05],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.963910761154856},"annotations":[{"text":"P_ISEV","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"4014678e6d43":{"fill":{},"x":{},"type":"bar"}},"cur_data":"4014678e6d43","visdat":{"4014678e6d43":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
While the largest number of accidents coincide with a safety device being used, it is more likely that this is because most people actually use a safety device while traveling. This is why a percentage bar chart is important to show a better picture. It is probably not surprising that the highest percentage of fatalities is where there is no safety being used. The highest number of injuries is for people wearing helmets, but this is because this is directly linked to motorcycle and moped riders, where the risk of injury and fatality is naturally much higher. Also interesting is category 13, which although shows no safety device equipped, is almost equivalent in percentage terms to category 02 (safety device equipped). This is because category 13 includes vehicles such as buses, where it is quite rare to experience any injury or accident at all due to how large it is and the way it operates.</p>
<pre class="r"><code>#safety device used and severity

ggplotly(ggplot(acc_clean, aes(P_SAFE)) +
  geom_bar(aes(fill = P_ISEV), stat = &quot;count&quot;) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle(&quot;Medical treatment by safety device used (absolute)&quot;) +
  scale_fill_manual(values = c(&quot;limegreen&quot;, &quot;paleturquoise2&quot;,&quot;red&quot;)) +
  theme_minimal())</code></pre>
<div id="htmlwidget-15" style="width:720px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-15">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9],"base":[80843,1714144,44566,19,12471,26721],"x":[1,2,3,4,5,6],"y":[14823,1379801,1722,2,1501,18726],"text":["count:   14823<br />P_ISEV: 1<br />P_SAFE: 01","count: 1379801<br />P_ISEV: 1<br />P_SAFE: 02","count:    1722<br />P_ISEV: 1<br />P_SAFE: 09","count:       2<br />P_ISEV: 1<br />P_SAFE: 10","count:    1501<br />P_ISEV: 1<br />P_SAFE: 12","count:   18726<br />P_ISEV: 1<br />P_SAFE: 13"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(50,205,50,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9],"base":[6571,12446,1559,0,242,307],"x":[1,2,3,4,5,6],"y":[74272,1701698,43007,19,12229,26414],"text":["count:   74272<br />P_ISEV: 2<br />P_SAFE: 01","count: 1701698<br />P_ISEV: 2<br />P_SAFE: 02","count:   43007<br />P_ISEV: 2<br />P_SAFE: 09","count:      19<br />P_ISEV: 2<br />P_SAFE: 10","count:   12229<br />P_ISEV: 2<br />P_SAFE: 12","count:   26414<br />P_ISEV: 2<br />P_SAFE: 13"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(174,238,238,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9],"base":[0,0,0,0,0],"x":[1,2,3,5,6],"y":[6571,12446,1559,242,307],"text":["count:    6571<br />P_ISEV: 3<br />P_SAFE: 01","count:   12446<br />P_ISEV: 3<br />P_SAFE: 02","count:    1559<br />P_ISEV: 3<br />P_SAFE: 09","count:     242<br />P_ISEV: 3<br />P_SAFE: 12","count:     307<br />P_ISEV: 3<br />P_SAFE: 13"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.7108066971081,"r":7.30593607305936,"b":42.130898021309,"l":78.1735159817352},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Medical treatment by safety device used (absolute)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,6.6],"tickmode":"array","ticktext":["01","02","09","10","12","13"],"tickvals":[1,2,3,4,5,6],"categoryorder":"array","categoryarray":["01","02","09","10","12","13"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"P_SAFE","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-154697.25,3248642.25],"tickmode":"array","ticktext":["0","1,000,000","2,000,000","3,000,000"],"tickvals":[0,1000000,2000000,3000000],"categoryorder":"array","categoryarray":["0","1,000,000","2,000,000","3,000,000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.963910761154856},"annotations":[{"text":"P_ISEV","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"4014d49327b":{"fill":{},"x":{},"type":"bar"}},"cur_data":"4014d49327b","visdat":{"4014d49327b":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>ggplotly(ggplot(acc_clean, aes(P_SAFE)) +
  geom_bar(aes(fill = P_ISEV), stat = &quot;count&quot;, position = &quot;fill&quot;) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle(&quot;Medical treatment by safety device used (percentage)&quot;) +
  scale_fill_manual(values = c(&quot;limegreen&quot;, &quot;paleturquoise2&quot;,&quot;red&quot;)) +
  theme_minimal())</code></pre>
<p><div id="htmlwidget-16" style="width:720px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-16">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9],"base":[0.845054669370518,0.554031826680823,0.96279813342551,0.904761904761905,0.89257085599771,0.587959601293815],"x":[1,2,3,4,5,6],"y":[0.154945330629482,0.445968173319177,0.0372018665744901,0.0952380952380952,0.10742914400229,0.412040398706185],"text":["count: 0.154945331<br />P_ISEV: 1<br />P_SAFE: 01","count: 0.445968173<br />P_ISEV: 1<br />P_SAFE: 02","count: 0.037201867<br />P_ISEV: 1<br />P_SAFE: 09","count: 0.095238095<br />P_ISEV: 1<br />P_SAFE: 10","count: 0.107429144<br />P_ISEV: 1<br />P_SAFE: 12","count: 0.412040399<br />P_ISEV: 1<br />P_SAFE: 13"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(50,205,50,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9],"base":[0.0686868898041101,0.0040226959432052,0.0336804355340477,0,0.0173203549957057,0.00675512135014412],"x":[1,2,3,4,5,6],"y":[0.776367779566408,0.550009130737618,0.929117697891462,0.904761904761905,0.875250501002004,0.581204479943671],"text":["count: 0.776367780<br />P_ISEV: 2<br />P_SAFE: 01","count: 0.550009131<br />P_ISEV: 2<br />P_SAFE: 02","count: 0.929117698<br />P_ISEV: 2<br />P_SAFE: 09","count: 0.904761905<br />P_ISEV: 2<br />P_SAFE: 10","count: 0.875250501<br />P_ISEV: 2<br />P_SAFE: 12","count: 0.581204480<br />P_ISEV: 2<br />P_SAFE: 13"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(174,238,238,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9],"base":[0,0,0,0,0],"x":[1,2,3,5,6],"y":[0.0686868898041101,0.0040226959432052,0.0336804355340477,0.0173203549957057,0.00675512135014412],"text":["count: 0.068686890<br />P_ISEV: 3<br />P_SAFE: 01","count: 0.004022696<br />P_ISEV: 3<br />P_SAFE: 02","count: 0.033680436<br />P_ISEV: 3<br />P_SAFE: 09","count: 0.017320355<br />P_ISEV: 3<br />P_SAFE: 12","count: 0.006755121<br />P_ISEV: 3<br />P_SAFE: 13"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.7108066971081,"r":7.30593607305936,"b":42.130898021309,"l":48.9497716894977},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Medical treatment by safety device used (percentage)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,6.6],"tickmode":"array","ticktext":["01","02","09","10","12","13"],"tickvals":[1,2,3,4,5,6],"categoryorder":"array","categoryarray":["01","02","09","10","12","13"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"P_SAFE","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.05,1.05],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.963910761154856},"annotations":[{"text":"P_ISEV","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"40146f117151":{"fill":{},"x":{},"type":"bar"}},"cur_data":"40146f117151","visdat":{"40146f117151":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
As stated earlier, majority of the people classified in this data set are either motor vehicle drivers or passengers. The highest percentage of injury however is attributed to bicycle riders, and the highest fatality percentage is for motorcyclists.</p>
<pre class="r"><code>#road user class and medical treatment

ggplotly(ggplot(acc_clean, aes(P_USER)) +
  geom_bar(aes(fill = P_ISEV), stat = &quot;count&quot;) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle(&quot;Medical treatment by road user class (absolute)&quot;) +
  scale_fill_manual(values = c(&quot;limegreen&quot;, &quot;paleturquoise2&quot;,&quot;red&quot;)) +
  theme_minimal())</code></pre>
<div id="htmlwidget-17" style="width:720px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-17">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9,0.9],"base":[1239112,587722,2865,49065],"x":[1,2,3,4],"y":[933364,480468,76,2667],"text":["count:  933364<br />P_ISEV: 1<br />P_USER: 1","count:  480468<br />P_ISEV: 1<br />P_USER: 2","count:      76<br />P_ISEV: 1<br />P_USER: 4","count:    2667<br />P_ISEV: 1<br />P_USER: 5"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(50,205,50,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9],"base":[13505,5897,13,1710],"x":[1,2,3,4],"y":[1225607,581825,2852,47355],"text":["count: 1225607<br />P_ISEV: 2<br />P_USER: 1","count:  581825<br />P_ISEV: 2<br />P_USER: 2","count:    2852<br />P_ISEV: 2<br />P_USER: 4","count:   47355<br />P_ISEV: 2<br />P_USER: 5"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(174,238,238,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9],"base":[0,0,0,0],"x":[1,2,3,4],"y":[13505,5897,13,1710],"text":["count:   13505<br />P_ISEV: 3<br />P_USER: 1","count:    5897<br />P_ISEV: 3<br />P_USER: 2","count:      13<br />P_ISEV: 3<br />P_USER: 4","count:    1710<br />P_ISEV: 3<br />P_USER: 5"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.7108066971081,"r":7.30593607305936,"b":42.130898021309,"l":78.1735159817352},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Medical treatment by road user class (absolute)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,4.6],"tickmode":"array","ticktext":["1","2","4","5"],"tickvals":[1,2,3,4],"categoryorder":"array","categoryarray":["1","2","4","5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"P_USER","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-108623.8,2281099.8],"tickmode":"array","ticktext":["0","500,000","1,000,000","1,500,000","2,000,000"],"tickvals":[0,500000,1000000,1500000,2000000],"categoryorder":"array","categoryarray":["0","500,000","1,000,000","1,500,000","2,000,000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.963910761154856},"annotations":[{"text":"P_ISEV","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"4014307d42ac":{"fill":{},"x":{},"type":"bar"}},"cur_data":"4014307d42ac","visdat":{"4014307d42ac":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>ggplotly(ggplot(acc_clean, aes(P_USER)) +
  geom_bar(aes(fill = P_ISEV), stat = &quot;count&quot;, position = &quot;fill&quot;) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle(&quot;Medical treatment by road user class (percentage)&quot;) +
  scale_fill_manual(values = c(&quot;limegreen&quot;, &quot;paleturquoise2&quot;,&quot;red&quot;)) +
  theme_minimal())</code></pre>
<p><div id="htmlwidget-18" style="width:720px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-18">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9,0.9],"base":[0.570368556430543,0.550203615461669,0.97415844950697,0.948445836232893],"x":[1,2,3,4],"y":[0.429631443569457,0.449796384538331,0.0258415504930296,0.0515541637671074],"text":["count: 0.429631444<br />P_ISEV: 1<br />P_USER: 1","count: 0.449796385<br />P_ISEV: 1<br />P_USER: 2","count: 0.025841550<br />P_ISEV: 1<br />P_USER: 4","count: 0.051554164<br />P_ISEV: 1<br />P_USER: 5"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(50,205,50,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9],"base":[0.0062164092952005,0.00552055345959052,0.00442026521591295,0.0330549756437022],"x":[1,2,3,4],"y":[0.564152147135342,0.544683062002078,0.969738184291057,0.91539086058919],"text":["count: 0.564152147<br />P_ISEV: 2<br />P_USER: 1","count: 0.544683062<br />P_ISEV: 2<br />P_USER: 2","count: 0.969738184<br />P_ISEV: 2<br />P_USER: 4","count: 0.915390861<br />P_ISEV: 2<br />P_USER: 5"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(174,238,238,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9],"base":[0,0,0,0],"x":[1,2,3,4],"y":[0.0062164092952005,0.00552055345959052,0.00442026521591295,0.0330549756437022],"text":["count: 0.006216409<br />P_ISEV: 3<br />P_USER: 1","count: 0.005520553<br />P_ISEV: 3<br />P_USER: 2","count: 0.004420265<br />P_ISEV: 3<br />P_USER: 4","count: 0.033054976<br />P_ISEV: 3<br />P_USER: 5"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.7108066971081,"r":7.30593607305936,"b":42.130898021309,"l":48.9497716894977},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Medical treatment by road user class (percentage)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,4.6],"tickmode":"array","ticktext":["1","2","4","5"],"tickvals":[1,2,3,4],"categoryorder":"array","categoryarray":["1","2","4","5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"P_USER","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.05,1.05],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.963910761154856},"annotations":[{"text":"P_ISEV","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"40145caa7da3":{"fill":{},"x":{},"type":"bar"}},"cur_data":"40145caa7da3","visdat":{"40145caa7da3":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
Finally, in an attempt to paint an overall picture of the interaction between the variables, a correlation plot is shown. The year variable is removed to remove any evolutionary impact of time series (and it is not needed for any further analysis from this point). As the variables are not ordinal at all and are all categorical, the Cramer’s V is calculated and plotted to show the strength of association between the variables. The function below was copied from Stackoverflow (the link is provided in the code comments), with some minor changes to fit this specific purpose. Also to be noted is that all chi-square p-values were zero for every combination, implying statistical significance for each value of Cramer’s V. This chart is not interactive.</p>
<pre class="r"><code>#Correlation with Cramers V

#removing collision year to ignore time series impact
acc_corr &lt;- acc_clean[,-1]

#from https://stackoverflow.com/a/52557631
f = function(x,y) {
  tbl = acc_corr %&gt;% select(x,y) %&gt;% table()
  chisq_pval = round(chisq.test(tbl)$p.value, 4) #calculate chi-sqr value
  cramV = round(cramersV(tbl), 3) #calculate cramer V 
  data.frame(x, y, chisq_pval, cramV) }

# create unique combinations of column names
# sorting will help getting a better plot (upper triangular)
df_comb = data.frame(t(combn(sort(names(acc_corr)), 2)), stringsAsFactors = F)

# apply function to each variable combination
df_res = map2_df(df_comb$X1, df_comb$X2, f)

#filter out chi-square as all are equal to zero, implying statistical significance
df_res &lt;- df_res[, -3]

# plot results
corr_plot &lt;- df_res %&gt;%
  ggplot(aes(x,y,fill=cramV))+
  geom_tile()+
  geom_text(aes(x,y,label=cramV))+
  scale_color_gradient()+
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 25, hjust = 1),
        axis.title.x = element_blank(),
        axis.title.y = element_blank())

corr_plot</code></pre>
<p><img src="/blog/Accidents-Canada_files/figure-html/unnamed-chunk-18-1.png" width="864" /></p>
<p>While majority of the variables have very weak association, there are some strong combinations shown:
(V_TYPE - P_USER, P_USER - P_PSN/SAFE, P_ISEV - C_SEV, C_WTHR - C_RSUR, V_TYPE - P_SAFE)</p>
<p>Many of these are quite obvious, such as the similarity between vehicle type and the road class user. Also, as mentioned earlier, there is a somewhat stronger association between the weather and the road surface condition. A strong association is also between the severity and the medical treatment required, which both more or less provide the same information.</p>
</div>
<div id="classification-of-severity" class="section level3">
<h3>Classification of Severity</h3>
<p>Having explored how severity of accidents is related to majority of the variables, it is now time to briefly investigate whether it is possible to predict accident severity using a classification model. Two simple classification models will be used, the logistic regression, and the generalized linear model with regularization. No manual parameter tuning or highly complex methods are being used here, as the purpose is to only see whether initial results are promising enough to warrant further attempts.</p>
<p>Two things to note before progressing: Firstly, the data is such that there are two potential candidates for the target variable (C_SEV and P_ISEV). C_SEV is chosen as it leads to binary classification, making things relatively simpler to understand. Therefore, P_ISEV is removed (justified by the previous correlation plot as well). Secondly, due to memory constraints, the entire 3 million plus observations could not be used, so only a very minor portion of the data is utilized. While this may not lead to the most true representation of accuracy, it should be sufficient for this specific purpose.</p>
<p>Before jumping into the models, first the target variable itself is examined.</p>
<pre class="r"><code>#class imbalance for target variable

table(Severity = acc_corr$C_SEV)</code></pre>
<pre><code>## Severity
##       1       2 
##   53890 3241449</code></pre>
<p>As it may have been evident by now, there is a severe class imbalance. Undersampling may be the easiest way to fix this, but the cost of information loss may be too great in this case given the difference between the two classes. Oversampling will also not work for this reason, as it will very likely lead to overfitting (Due to repeated observations). A third option is to use synthetic data generating techniques. The function used here ‘creates a sample of synthetic data by enlarging the features space of minority and majority class examples using a smoothed bootstrap approach’ (paraphrased from the documentation). To simplify, it generates data within the original data using algorithms such that the number of classes is equal, while avoiding the pitfalls of under and overfitting. However, synthetic data generation is a bit of an ethical dilemma, as it revolves around the territory of falsifying data, so it should be used with care and not to make any outrageous or influential claims about the data.</p>
<pre class="r"><code>#ROSE function - (as seen in documentation) creates a sample of synthetic data by
  #enlarging the features space of minority and majority class examples using a
  # smoothed bootstrap approach. 

acc_corr &lt;- acc_corr[,-17]

acc_synth &lt;- ROSE(C_SEV ~ ., data = acc_corr, seed = 1234, N = 3295339)$data

#need to select smaller data size due to memory constraints (0.5% of 3 million)

acc_synth_sm &lt;- acc_synth[sample(nrow(acc_synth), (nrow(acc_synth) * 0.005)), ]

table(acc_synth_sm$C_SEV)</code></pre>
<pre><code>## 
##    2    1 
## 8151 8325</code></pre>
<p>The table above shows that the classes are now much more balanced than before, with approximately 16000 total observations being used. The next steps split the data into a 70/30 train-test split, apply a 5-fold standard cross-validation technique to improve accuracy and apply the models. This is carried out in the code chunk below.</p>
<pre class="r"><code>##splitting the data into train-test samples

set.seed(1234)
acc_split &lt;- initial_split(acc_synth_sm, prop = 0.7, strata = &quot;C_SEV&quot;)
acc_train &lt;- training(acc_split)
acc_test &lt;- testing(acc_split)

##define cross-validation method

cv &lt;- trainControl(method = &quot;cv&quot;, number = 5)

##Logistic and Regularized model training

set.seed(1234)
acc_logistic &lt;- train(C_SEV ~ .,
                      data = acc_train,
                      method = &#39;glm&#39;,
                      family = &#39;binomial&#39;,
                      trControl = cv)

set.seed(1234)
acc_glmregular &lt;- train(C_SEV ~ .,
                        data = acc_train,
                        method = &#39;glmnet&#39;,
                        trControl = cv)</code></pre>
<p>To assess the accuracy of the models on the training data, the accuracy and Kappa metrics are used to provide a fair picture, as the Kappa value will take into account the random chance of correct classification.</p>
<pre class="r"><code>#Accuracy Metric
summary(resamples(list(
  Logistic  = acc_logistic,
  Regularized = acc_glmregular
)))$statistics$Accuracy</code></pre>
<pre><code>##                  Min.   1st Qu.    Median      Mean   3rd Qu.      Max.
## Logistic    0.7393755 0.7468574 0.7497832 0.7503888 0.7538995 0.7620286
## Regularized 0.7402428 0.7481578 0.7508666 0.7510829 0.7523851 0.7637625
##             NA&#39;s
## Logistic       0
## Regularized    0</code></pre>
<pre class="r"><code>#Kappa Metric
summary(resamples(list(
  Logistic  = acc_logistic,
  Regularized = acc_glmregular
)))$statistics$Kappa</code></pre>
<pre><code>##                  Min.   1st Qu.    Median      Mean   3rd Qu.      Max.
## Logistic    0.4789721 0.4937029 0.4997334 0.5009013 0.5079852 0.5241131
## Regularized 0.4806873 0.4963085 0.5019351 0.5022965 0.5049534 0.5275982
##             NA&#39;s
## Logistic       0
## Regularized    0</code></pre>
<p>Both models seem to be performing very similarly, with the regularized model performing only marginally better. While the accuracy metric shows some promise, the Kappa value of an average of 0.5 for each model shows that the element of chance is quite evident in this case. It may be useful to see how these models perform on the test data using confusion matrices.</p>
<pre class="r"><code>#logistic model
logistic_pred &lt;- predict(acc_logistic, acc_test) 
confusionMatrix(data = relevel(logistic_pred, ref = 2),
                reference = relevel(acc_test$C_SEV, ref = 2))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    1    2
##          1 2207 1445
##          2  290 1000
##                                           
##                Accuracy : 0.6489          
##                  95% CI : (0.6354, 0.6622)
##     No Information Rate : 0.5053          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.2943          
##                                           
##  Mcnemar&#39;s Test P-Value : &lt; 2.2e-16       
##                                           
##             Sensitivity : 0.8839          
##             Specificity : 0.4090          
##          Pos Pred Value : 0.6043          
##          Neg Pred Value : 0.7752          
##              Prevalence : 0.5053          
##          Detection Rate : 0.4466          
##    Detection Prevalence : 0.7390          
##       Balanced Accuracy : 0.6464          
##                                           
##        &#39;Positive&#39; Class : 1               
## </code></pre>
<pre class="r"><code>#regularized model
glmregular_pred &lt;- predict(acc_glmregular, acc_test) 
confusionMatrix(data = relevel(glmregular_pred, ref = 2),
                reference = relevel(acc_test$C_SEV, ref = 2))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    1    2
##          1 1827  564
##          2  670 1881
##                                          
##                Accuracy : 0.7503         
##                  95% CI : (0.738, 0.7623)
##     No Information Rate : 0.5053         
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16      
##                                          
##                   Kappa : 0.5008         
##                                          
##  Mcnemar&#39;s Test P-Value : 0.002799       
##                                          
##             Sensitivity : 0.7317         
##             Specificity : 0.7693         
##          Pos Pred Value : 0.7641         
##          Neg Pred Value : 0.7374         
##              Prevalence : 0.5053         
##          Detection Rate : 0.3697         
##    Detection Prevalence : 0.4838         
##       Balanced Accuracy : 0.7505         
##                                          
##        &#39;Positive&#39; Class : 1              
## </code></pre>
<p>The results from the confusion matrices are much more interesting. Here the regularized model appears to be performing much better than the logistic model when applied to the testing data. The accuracy and Kappa values are both higher for the regularized model. While the the logistic model has a higher sensitivity, the specificity is quite low, whereas the regularized model has a much more balanced sensitivity and specificity. Observing the actual values in the matrices themselves shows even more variation. While the logistic model correctly classifies Class 1 more, the regularized model correctly classifies Class 2 more. To provide a more overall point of view on these two models, an ROC curve (along with the AUC value) is useful.</p>
<pre class="r"><code>#Calculate AUC

pred_ROCR_logistic &lt;- prediction(as.numeric(logistic_pred), 
                             as.numeric(acc_test$C_SEV))

perf_ROCR_logistic &lt;- performance(pred_ROCR_logistic, 
                              measure = &quot;tpr&quot;, x.measure = &quot;fpr&quot;)

auc_ROCR_logistic &lt;- performance(pred_ROCR_logistic, measure = &quot;auc&quot;)
auc_ROCR_logistic &lt;- auc_ROCR_logistic@y.values[[1]]


pred_ROCR_glmregular &lt;- prediction(as.numeric(glmregular_pred), 
                                 as.numeric(acc_test$C_SEV))

perf_ROCR_glmregular &lt;- performance(pred_ROCR_glmregular, 
                                  measure = &quot;tpr&quot;, x.measure = &quot;fpr&quot;)

auc_ROCR_glmregular &lt;- performance(pred_ROCR_glmregular, measure = &quot;auc&quot;)
auc_ROCR_glmregular &lt;- auc_ROCR_glmregular@y.values[[1]]

data.frame(&quot;Logistic&quot; = auc_ROCR_logistic, &quot;Regularized&quot; = auc_ROCR_glmregular) </code></pre>
<pre><code>##    Logistic Regularized
## 1 0.6464293   0.7505016</code></pre>
<pre class="r"><code>#Plot ROC

plot(perf_ROCR_logistic, col = &quot;red&quot;, lty = 2)
plot(perf_ROCR_glmregular, add = TRUE, col = &quot;blue&quot;, lty = 3)
legend(0.8, 0.2, legend = c(&quot;Logistic&quot;, &quot;Regularized&quot;),
       col = c(&quot;red&quot;, &quot;blue&quot;), lty = c(2, 3), cex = 1)</code></pre>
<p><img src="/blog/Accidents-Canada_files/figure-html/unnamed-chunk-24-1.png" width="864" /></p>
</div>
<div id="conclusion" class="section level3">
<h3>Conclusion</h3>
<p>Based on the ROC curve and the AUC value, the regularized model seems to be the better choice. However, this is only a highly simple attempt to classify the severity of accidents based on some features, that to on a very small portion of the data. The variability within the different metrics of the two models could simply be because given the nature of the data (and how there are class imbalances within the independent variables themselves), the chosen sample size is much too small and the models are unable to find any consistent pattern. Perhaps with more computing power and a larger sample, the results may differ. Also, very basic cross-validation is used as opposed to the more robust repeated cross-validation. This may potentially be a problem as simple cross-validation tends to suffer from higher variance in the bias-variance trade-off, whereas repeated cross-validation manages to lower both bias and variance by being more robust. Perhaps simply using a more complex model like Random Forests or Support Vector Machines can be more useful. At the end of the day, it really depends on the use case and what is specifically required. One could even question how useful being able to successfully predict the severity of accidents really is.</p>
</div>


              
          </article>
          

 <div class="pagination">
  
    <a class="pagination__item" href="/blog/whr-2019/">
        <span class="pagination__label">Previous Post</span>
        <span class="pagination__title">Visualizing Happiness - World Happiness Report 2019</span>
    </a>
  

  
    <a class="pagination__item" href="/blog/us-unemp/">
      <span class="pagination__label">Next Post</span>
      <span class="pagination__title" >US Unemployment - Time Series and Neural Networks</a>
    </a>
  
</div>

          
          <footer class="post__footer">
            


<div class="social-icons">
  
     
    
  
     
    
  
     
    
  
     
    
  
     
    
  
     
    
  
     
    
  
     
    
     
</div>

            <p>© 2020 fazi_rda</p>
          </footer>
          </div>
      </div>
      
    </div>
    

  </main>

   

  
  <script src="/js/index.min.49e4d8a384357d9b445b87371863419937ede9fa77737522ffb633073aebfa44.js" integrity="sha256-SeTYo4Q1fZtEW4c3GGNBmTft6fp3c3Ui/7YzBzrr&#43;kQ=" crossorigin="anonymous"></script>
  
  
  <script src="https://unpkg.com/prismjs@1.20.0/components/prism-core.min.js"></script>

  
  <script src="https://unpkg.com/prismjs@1.20.0/plugins/autoloader/prism-autoloader.min.js"
    data-autoloader-path="https://unpkg.com/prismjs@1.20.0/components/"></script>

  


</body>

</html>
